
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Midterm Exam &#8212; Data Analysis in Finance</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Our Exams" href="exam_intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/cat.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Data Analysis in Finance</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome!
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1_finpyth.html">
   Why Python and finance?
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="2_intro.html">
   Python set-up
   <a id="python_set-up">
   </a>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="2_0_install.html">
     Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_1_jupyter.html">
     Jupyter notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_2_vscode.html">
     VS Code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_3_markdown.html">
     Markdown
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_4_packages.html">
     Packages
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The Basics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="3_intro.html">
   CompSci 101: Data and arrays
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="3_0_comp101.html">
     The Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="3_1_numpy.html">
     Numpy and arrays
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="4_intro.html">
   Importing and using data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="4_0_dataframes.html">
     Data importing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_1_pandas.html">
     pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_2_cleaning_data.html">
     Cleaning our data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_3_eda.html">
     Exploratory data analysis (EDA)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_4_merge_shape.html">
     Merging and reshaping data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="5_intro.html">
   Data visualization
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="5_0_matplotlib.html">
     matplotlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="5_1_plotly.html">
     plotly
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="5_2_seaborn.html">
     seaborn
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6_financial_ts.html">
   Financial time series
   <a id="financial-time-series">
   </a>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Applications
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="7_nasdaq_api.html">
   Using NASDAQ BTC Data
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Labs
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="lab_intro.html">
   Our labs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab01.html">
   Lab 01
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab02.html">
   Lab 02
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab03.html">
   Lab 03
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab04.html">
   Lab 04
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab05.html">
   Lab 05
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Exams
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="exam_intro.html">
   Our Exams
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Midterm Exam
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/chapters/exam01.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/chapters/exam01.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Midterm Exam
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#academic-honesty-statement">
     Academic Honesty Statement
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-note-about-grading">
     A note about grading
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exam-name">
     Exam name
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#our-questions">
   Our Questions
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Midterm Exam</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Midterm Exam
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#academic-honesty-statement">
     Academic Honesty Statement
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-note-about-grading">
     A note about grading
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exam-name">
     Exam name
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#our-questions">
   Our Questions
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="midterm-exam">
<h1>Midterm Exam<a class="headerlink" href="#midterm-exam" title="Permalink to this headline">¶</a></h1>
<div class="section" id="academic-honesty-statement">
<h2>Academic Honesty Statement<a class="headerlink" href="#academic-honesty-statement" title="Permalink to this headline">¶</a></h2>
<p><strong>THIS IS AN INDIVIDUAL ASSESSMENT. THIS DOCUMENT AND YOUR ANSWERS ARE FOR YOUR EYES ONLY. ANY VIOLATION OF THIS POLICY WILL BE IMMEDIATELY REPORTED TO THE ELON HONOR BOARD.</strong></p>
<p><em>Add the text below to the first cell of your notebook. Replace the underscores below with your name acknowledging that you have read and understood our academic community standard.</em></p>
<p>I, ____________, hereby state that I have not communicated with or gained information in any way from my classmates or anyone other than Professor Aiken during this exam, and that all work is my own. I have properly cited any code that I have used from other sources.</p>
</div>
<div class="section" id="a-note-about-grading">
<h2>A note about grading<a class="headerlink" href="#a-note-about-grading" title="Permalink to this headline">¶</a></h2>
<p>This is an exam, not a lab. <strong>I do not expect everyone to be able to answer every question.</strong> As with any exam, you do not start with 100 points and then subtract. You are starting with zero and then earning credit. For certain questions, I have indicated what you need to do in order to earn full credit.</p>
<p>While code correctness is the most important component of the exam, I will also be looking for well-formatted graphs, proper use of Markdown, thoughtful writing, and easy-to-read code. You need to pay attention to these items to earn full credit.</p>
<p><strong>If you get stuck because you can’t complete the first part of a question</strong>, write commented code (i.e. put a <code class="docutils literal notranslate"><span class="pre">#</span></code> in front of each line of code inside the cell) that does what you <strong>would do</strong> if you have the correct inputs. <strong>There is partial credit.</strong></p>
</div>
<div class="section" id="exam-name">
<h2>Exam name<a class="headerlink" href="#exam-name" title="Permalink to this headline">¶</a></h2>
<p>Open up your folder for this class and create a new <code class="docutils literal notranslate"><span class="pre">exam1</span></code> folder. Save your Jupyter Notebook in the folder. Call this file <code class="docutils literal notranslate"><span class="pre">lastname_firstname_exam1</span></code>.</p>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="our-questions">
<h1>Our Questions<a class="headerlink" href="#our-questions" title="Permalink to this headline">¶</a></h1>
<p>Please answer the following questions in order.</p>
<p><strong>Use Markdown to clearly mark your questions and answers, as well as for formatting any discussion.</strong></p>
<p>We are going to start with, you guessed it, housing data. This data is a sample of Zillow data from a <a class="reference external" href="https://www.kaggle.com/c/zillow-prize-1">Kaggle data contest</a>, where the idea was to help Zillow improve the company’s “Zestimate” value for each home. There was $1.2 million in prize money awarded. Zillow recently lost a bunch of money trying to buy and sell homes based, in part, on their Zestimate. Not because the Zestimate is necessarily flawed. Instead, they ran into a problem called <strong>adverse selection</strong> where the homes that looked undervalued were only undervalued because the homeowner knew that there were serious problems that Zillow didn’t know about.</p>
<p>I’ve posted the data dictionary on <a class="reference external" href="https://github.com/aaiken1/fin-data-analysis-python/">Github</a>, if you have questions about the variable definitions. We are only going to use a small number of them. The main data set (properties_2016_sample10_1.csv) has housing characteristics for houses listed in three Southern California counties in 2016. The other data set (train_2016_v2.csv) contains the log(pricing error) for houses sold, as well as a transaction date. I’ll tell you more about the pricing error below.</p>
<ol class="simple">
<li><p><em>10 points</em> Let’s <strong>get our data into Python and Pandas</strong>.</p></li>
</ol>
<p>The housing data is here: <a class="reference external" href="https://raw.githubusercontent.com/aaiken1/fin-data-analysis-python/main/data/properties_2016_sample10_1.csv">https://raw.githubusercontent.com/aaiken1/fin-data-analysis-python/main/data/properties_2016_sample10_1.csv</a>
The pricing and transactions data is here: <a class="reference external" href="https://raw.githubusercontent.com/aaiken1/fin-data-analysis-python/main/data/train_2016_v2.csv">https://raw.githubusercontent.com/aaiken1/fin-data-analysis-python/main/data/train_2016_v2.csv</a></p>
<p>Load in the <strong>properties_2016_sample10_1.csv</strong> file. This is a random sample of 10% of the actual data from the contest. The real file was too large for our purposes. Then, load in the <strong>train_2016_v2.csv</strong> file. This file has the log(price error) for houses sold in the area, as well as the sale date. You might get a warning about mixed data types. That’s OK!</p>
<p><strong>Inspect the data using appropriate Python methods</strong>. Briefly describe that types of variables that you see. There are a lot, so just give me a general sense.</p>
<p><strong>Merge them together</strong> and keep only the observations in both data sets. Call the resulting data frame <em>zillow_data</em>.</p>
<ol class="simple">
<li><p><em>5 points</em> What is the <strong>min and max transaction date in the data</strong>? To do this, you’ll want to get the date into a proper DateTime format first.</p></li>
</ol>
<p><strong>Do the min and max date make sense?</strong> Always good to check these sorts of things in your data!</p>
<ol class="simple">
<li><p><em>10 points</em> First, what are the <strong>fifteen most common vales for <em>yearbuilt</em> in the data</strong>? To do this, you’ll want to combine a <code class="docutils literal notranslate"><span class="pre">groupby</span></code> and a <code class="docutils literal notranslate"><span class="pre">.agg('count')</span></code>, where you are counting <em>logerror</em>.</p></li>
</ol>
<p>Note that the year built is, of course, different from the transaction date.</p>
<p>Then, what are the <strong>fifteen most common county/zip code pairs in the data</strong>? These columns are <em>regionidcounty</em> and <em>regionidzip</em>, respectively. Again, <code class="docutils literal notranslate"><span class="pre">groupby</span></code> and <code class="docutils literal notranslate"><span class="pre">.agg('count')</span></code> are your friends.</p>
<p>For both parts, how can you show the most common values in your notebook? Should the data, perhaps, be sorted in a particular way?</p>
<p>By the way, I searched for the Zip codes and couldn’t find a lot of them! But, the long-lats given in the data seem to work. No idea why.</p>
<ol class="simple">
<li><p><em>10 points</em> Create a <strong>summary of the mean and median number of bedrooms and bathrooms by year built</strong> for all houses in the data. Then, do the same thing, but <strong>filter</strong> to only include houses built after 1990.</p></li>
</ol>
<p>Round everything to one decimal place. See our notes and text for examples. You’re again thinking in terms of groups and <code class="docutils literal notranslate"><span class="pre">.agg()</span></code>. What functions do you use inside of <code class="docutils literal notranslate"><span class="pre">.agg()</span></code> to get the mean and median?</p>
<ol class="simple">
<li><p><em>10 points</em> Are there any <strong>duplicate parcel ID’s</strong> in the data? In other words, does the same house appear more than once?</p></li>
</ol>
<p>Create a new DataFrame with just the parcel ID, the pricing error, and the transaction date and show any observations that have multiple parcel IDs (i.e. dupes) in your notebook. To do this, use <code class="docutils literal notranslate"><span class="pre">.duplicated()</span></code> from <code class="docutils literal notranslate"><span class="pre">pandas</span></code> and the idea of <strong>masking</strong> from the DataCamp.</p>
<p>See here for the syntax: <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.duplicated.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.duplicated.html</a>. Within <code class="docutils literal notranslate"><span class="pre">.duplicated()</span></code>, you’ll want to subset on the parcel ID and choose <code class="docutils literal notranslate"><span class="pre">keep</span> <span class="pre">=</span> <span class="pre">False</span></code>. This function returns <strong>True or False</strong> for each observation in your DataFrame according to whether or not it is a duplicate. Here we’re checking for duplicate parcel IDs, but if you leave out that argument, then an observation would need to be a duplicate (i.e. have the same values) across all three of the variables.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">.duplicated</span></code> to create a DataFrame of True or False values. Then, use this DataFrame to <strong>mask</strong> and only select duplicated observations (i.e. observations where <code class="docutils literal notranslate"><span class="pre">.duplicated</span></code> returned <em>true</em>) from your subset of data with only parcel ID, the pricing error, and the transaction date. Call this new DataFrame <em>non_unique_data</em>.</p>
<p>Show these values in your notebook. <strong>What’s going on with these observations?</strong> Why do a small number of houses appear twice?</p>
<ol class="simple">
<li><p><em>15 points</em> Where does Zillow do the worst job at pricing homes? In other words, where do their Zestimates have the largest absolute difference from the actual sale price? The pricing error is called <em>logerror</em> in the data.</p></li>
</ol>
<div class="amsmath math notranslate nohighlight" id="equation-54c933df-bb73-4052-9c34-53e7124ce220">
<span class="eqno">(8)<a class="headerlink" href="#equation-54c933df-bb73-4052-9c34-53e7124ce220" title="Permalink to this equation">¶</a></span>\[\begin{align}
log(pricing error) = log(Zestimate) − log(SalePrice)
\end{align}\]</div>
<p>Log here means the natural log. We often take the natural log of data, as the log has some nice properties (i.e. reduces the skew of the data, the influence of outliers).</p>
<p>First, <strong>count up the number of houses sold in each zip code</strong> and create a new variable called <em>houses_sold</em>. To do this, use the usual variable creation and <code class="docutils literal notranslate"><span class="pre">groupby</span></code>, but use the method <code class="docutils literal notranslate"><span class="pre">.transform('count')</span></code> from <code class="docutils literal notranslate"><span class="pre">pandas</span></code> to count <em>logerror</em> by zip code. <code class="docutils literal notranslate"><span class="pre">.transform</span></code> will add a new column, with counts by zip code, that will become the new variable. Since each Zip code can appear many times in the data, the same count will appear multiple times.</p>
<p>Next, only keep zip codes where 10 or more houses are sold and <strong>save this set to a new DataFrame</strong>. So, more filtering based on a condition. Add <code class="docutils literal notranslate"><span class="pre">.copy()</span></code> at the end of your filtering statement to get rid of a potential warning from Python. Why? When you’re doing something like New DataFrame = Old DataFrame[YOUR FILTER STATEMENT], Python wants you to be explicit that you are copying over a subset of the old DataFrame with a new one.</p>
<p>It will look like this: New DataFrame = Old DataFrame[YOUR FILTER STATEMENT].copy(). We didn’t do this earlier because we weren’t saving the filtered data - we were just using it in another step in the same line of code.</p>
<p>We’re doing this to get rid of Zips with only a few houses sold in the data. Weird Zips in the middle of no where.</p>
<p>Then, using the new DataFrame, find the mean and median of the <strong>absolute value of the log error</strong> by zip code. So, another summary table and <code class="docutils literal notranslate"><span class="pre">groupby</span></code>. You can use <code class="docutils literal notranslate"><span class="pre">.abs()</span></code> to find the absolute value of a number.</p>
<p>Show the zips with the 10 largest mean pricing errors. Round to five decimal places.</p>
<p>What does the absolute value measure? What do the differences in means and medians tell you?</p>
<ol class="simple">
<li><p><em>10 points.</em> Go back to the original Zillow data (before you filtered the Zip codes above) and create that same absolute value of the log pricing error in it. Make two histograms, one for the absolute value of log pricing error for houses with 4 or fewer bedrooms and another one for houses with more than four bedrooms. Stack them on top of each other. Include appropriate labels and titles. <strong>What is this plot trying to answer?</strong></p></li>
</ol>
<p>See the problem sets and notes for some examples of this type of graph.</p>
<ol class="simple">
<li><p><em>10 points.</em> OK, enough housing data. Actually, we’ll just bring in some <strong>different</strong> housing data! Let’s end with some <strong>financial time series</strong> related to housing, also from Zillow. Use Quandl via the Nasdaq Data Link to bring in the following:</p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">regions</span> <span class="pre">=</span> <span class="pre">quandl.get_table(&quot;ZILLOW/REGIONS&quot;,</span> <span class="pre">paginate=True)</span></code></p>
<p>This will create a DataFrame called <em>regions</em> that has all of the different region types and values in the Zillow data. For example, you can pull cities, Zip codes, counties, metro-areas, etc. Note that this data is in a <strong>long format</strong>. See how this way of structuring data is useful? You can get all of the different regions and codes stacked on top of each other.</p>
<p><strong>Open up the <em>region</em> DataFrame in VS Code and search for the county that you’re from.</strong> You can do this by searching at the top of the <strong>region column</strong>. Look for <em>county</em> in the <strong>region_type</strong> column. Note the region ID for your county.</p>
<p>Now, bring in the following three data sets from Zillow: ZSFH, ZATT, and ZABT. These are overall single family home, top-tier, and bottom-tier price series. Modify this code as needed:</p>
<p><code class="docutils literal notranslate"><span class="pre">zsfh</span> <span class="pre">=</span> <span class="pre">quandl.get_table('ZILLOW/DATA',</span> <span class="pre">indicator_id='ZSFH',</span> <span class="pre">region_id=['1289',</span> <span class="pre">'2402'])</span></code></p>
<p>Add your own county ID to the list I included. Those are Orange County, NC and Maricopa County, AZ. So, you’ll bring in three price series for three counties. Save them to three different data frames.</p>
<ol class="simple">
<li><p><em>10 points.</em> Because we have <strong>long data</strong> that has the <strong>same variables</strong>, we can <strong>append</strong>, or stack, three DataFrames on top of each other. Do you see why?</p></li>
</ol>
<p>Do this. See the online notes for details. We have three DataFrames, so the logic is a lot like what we saw when <strong>merging</strong> three DataFrames in our lab. Save the DataFrame with all three variables across the three regions as a new DataFrame called <strong>indices</strong>.</p>
<ol class="simple">
<li><p><em>10 points.</em> Let’s calculate the <strong>percent change</strong> in housing values by region and indicator type. Keep this in mind: We are in <strong>long data</strong> now. We are going to need to sort our data and work by group. Think carefully about what our groups are. We have two! We always have to pay attention to how our data are structured. This type of data is called <strong>multi-level data</strong>. We have indicators and regions, by date. So, each value for each date, is uniquely identified by the indicator and the region.</p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">indices['pct']</span> <span class="pre">=</span> <span class="pre">indices.sort_values('____',</span> <span class="pre">ascending=True).groupby(['_______',</span> <span class="pre">'_______']).value.pct_change()</span></code></p>
<p>When you’re done, check the calculation. Where would you expect missing calculations?</p>
<p>It is actually often easier to do calculations like this in <strong>long data</strong> since you can group. When every variable is its own column, things get more cumbersome.</p>
<p>Let’s finish up with a graph. To do so, let’s <strong>keep certain data and get it into wide format</strong>.</p>
<p>First, <strong>select just the data for the ZSFH indicator</strong>.</p>
<p>Then, drop the <em>indicator_id</em> column. Why? There’s only one indicator ID now, so the column is redundant. Modify this code:</p>
<p><code class="docutils literal notranslate"><span class="pre">indices.drop('FILL</span> <span class="pre">IN</span> <span class="pre">COLUMN</span> <span class="pre">NAME',</span> <span class="pre">axis=1,</span> <span class="pre">inplace=True)</span></code></p>
<p>Note the <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>. <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> means that whatever you typed in is a column name.</p>
<p>Then, <strong>pivot the data</strong> to go wide. You can ignore that <em>pct</em> column now - we’ll drop it as we pivot. Modify this code:</p>
<p><code class="docutils literal notranslate"><span class="pre">indices</span> <span class="pre">=</span> <span class="pre">pd.pivot(indices,</span> <span class="pre">values='_____',</span> <span class="pre">columns='_____',</span> <span class="pre">index='_____')</span></code></p>
<p>See our online notes for an example.</p>
<p>Finally, use <code class="docutils literal notranslate"><span class="pre">.plot</span></code> from <code class="docutils literal notranslate"><span class="pre">pandas</span></code> to graph all three price series on the same chart. Make it look nice. The labels should appear automatically, though they will have the Zillow IDs, which don’t mean much. You can change that, but we’ll leave it for now. You’re done.</p>
<p><strong>ENJOY SPRING BREAK</strong></p>
<p>Please upload your Jupyter notebook to Moodle! I hope that this “exam” did more than just reinforce some basic data wrangling principles. I tried to introduce you to a few new tools and really show you how the day-to-day data process works. Financial data has its own peculiarities too.</p>
<p>By the way, 2402 is Maricopa County. See it in your graph? I bought a condo in 2005 and sold in 2010. This is why I don’t teach the real estate course.</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="exam_intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Our Exams</p>
        </div>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Prof. Adam Aiken<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>