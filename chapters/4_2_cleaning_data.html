
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>4.3. Cleaning our data &#8212; Data Analysis in Finance</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4.4. Exploratory data analysis (EDA)" href="4_3_eda.html" />
    <link rel="prev" title="4.2. pandas" href="4_1_pandas.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/cat.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Data Analysis in Finance</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1_finpyth.html">
   1. Why Python and finance?
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="2_1_intro.html">
   2. Python set-up
   <a id="python_set-up">
   </a>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="2_2_git.html">
     2.2. Using Github and Github Codespaces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_3_install.html">
     2.3. Local Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_4_jupyter.html">
     2.4. Jupyter notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_5_vscode.html">
     2.5. VS Code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_6_googlecolab.html">
     2.6. Google Colab
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_7_markdown.html">
     2.7. Markdown
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_8_packages.html">
     2.8. Packages
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_9_style.html">
     2.9. Code style, PEP8, and linting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_10_using_chatgpt.html">
     2.10. Using ChatGPT
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The Basics
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="3_1_intro.html">
   3. CompSci 101: Types, control, and numpy arrays
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="3_2_comp101.html">
     3.1. The Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="3_3_numpy.html">
     3.2. Numpy and arrays
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="4_intro.html">
   4. Pandas and data
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="4_0_dataframes.html">
     4.1. Data importing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_1_pandas.html">
     4.2. pandas
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     4.3. Cleaning our data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_3_eda.html">
     4.4. Exploratory data analysis (EDA)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_4_merge_shape.html">
     4.5. Merging and reshaping data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_5_sql.html">
     4.6. Using SQL in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_6_polar.html">
     4.7. polars: A fast, fancy pandas alternative
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="5_intro.html">
   5. Data visualization
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="5_0_seaborn.html">
     5.1. seaborn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="5_1_matplotlib.html">
     5.2. matplotlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="5_2_plotly.html">
     5.3. plotly
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6_nasdaq_api.html">
   6. Using APIs for Data Imports
   <a id="btc-sim">
   </a>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7_financial_ts.html">
   7. Financial time series
   <a id="financial-time-series">
   </a>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Applications
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="8_port_math.html">
   8. Essential portfolio math
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="9_portfolio_opt.html">
   9. Portfolio optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10_unsupervised_learning.html">
   10. Unsupervised Learning
   <a id="unsupervised_learning">
   </a>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11_factor_models.html">
   11. Factor models
   <a id="factor_models">
   </a>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12_regression_topics.html">
   12. Regression topics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13_logit_credit.html">
   13. Logit models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14_decision_trees.html">
   14. Decision Trees
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="15_svm.html">
   15. SVM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16_risk_mang.html">
   16. Risk management
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17_monte_carlo.html">
   17. Monte Carlo and portfolios
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="18_options.html">
   18. Option basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="19_reinforcement_learning.html">
   19. Reinforcement Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="20_trading_bt.html">
   20. Trading Strategies and the BT Package
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/chapters/4_2_cleaning_data.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapters/4_2_cleaning_data.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-integrity">
   4.3.1. Data Integrity
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#underwater-exploration">
   4.3.2. Underwater exploration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#counting-missings-and-dupes">
   4.3.3. Counting, missings, and dupes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sorting-our-data">
   4.3.4. Sorting our data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#renaming-columns">
   4.3.5. Renaming columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dropping-columns">
   4.3.6. Dropping columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#missing-data-example">
   4.3.7. Missing data example
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#back-to-stocks">
   4.3.8. Back to stocks
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pyjanitor">
   4.3.9. Pyjanitor
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Cleaning our data</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-integrity">
   4.3.1. Data Integrity
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#underwater-exploration">
   4.3.2. Underwater exploration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#counting-missings-and-dupes">
   4.3.3. Counting, missings, and dupes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sorting-our-data">
   4.3.4. Sorting our data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#renaming-columns">
   4.3.5. Renaming columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dropping-columns">
   4.3.6. Dropping columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#missing-data-example">
   4.3.7. Missing data example
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#back-to-stocks">
   4.3.8. Back to stocks
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pyjanitor">
   4.3.9. Pyjanitor
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="cleaning-our-data">
<h1><span class="section-number">4.3. </span>Cleaning our data<a class="headerlink" href="#cleaning-our-data" title="Permalink to this headline">#</a></h1>
<p>Cleaning your data and dealing with dates. That’s the life of anyone who deals with data, especially in finance. Most data sets are messy. This is especially true if you or your firm is the one collecting the data and not just purchasing something.</p>
<p>DataCamp has an article on <a class="reference external" href="https://www.datacamp.com/community/tutorials/data-preparation-with-pandas">cleaning data in <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a>.</p>
<p><a class="reference external" href="https://wesmckinney.com/book/data-cleaning.html">Chapter 7</a> of <em>Python for Data Analysis</em> for more data cleaning tips.</p>
<section id="data-integrity">
<h2><span class="section-number">4.3.1. </span>Data Integrity<a class="headerlink" href="#data-integrity" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://kieranhealy.org/blog/archives/2018/08/01/i-cant-believe-its-not-butter/">know how your data were created</a>.</p>
</section>
<section id="underwater-exploration">
<h2><span class="section-number">4.3.2. </span>Underwater exploration<a class="headerlink" href="#underwater-exploration" title="Permalink to this headline">#</a></h2>
<p>We’ll start by bringing in our Zillow data again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">uw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://github.com/aaiken1/fin-data-analysis-python/raw/main/data/zestimatesAndCutoffs_byGeo_uw_2017-10-10_forDataPage.csv&#39;</span><span class="p">)</span>
<span class="n">uw</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 2610 entries, 0 to 2609
Data columns (total 24 columns):
 #   Column                        Non-Null Count  Dtype  
---  ------                        --------------  -----  
 0   RegionType                    2610 non-null   object 
 1   RegionName                    2610 non-null   object 
 2   StateName                     2609 non-null   object 
 3   MSAName                       1071 non-null   object 
 4   AllHomes_Tier1                2610 non-null   float64
 5   AllHomes_Tier2                2610 non-null   float64
 6   AllHomes_Tier3                2610 non-null   float64
 7   AllHomes_AllTiers             2610 non-null   float64
 8   UWHomes_Tier1                 2610 non-null   float64
 9   UWHomes_Tier2                 2610 non-null   int64  
 10  UWHomes_Tier3                 2610 non-null   float64
 11  UWHomes_AllTiers              2610 non-null   float64
 12  UWHomes_TotalValue_Tier1      2610 non-null   float64
 13  UWHomes_TotalValue_Tier2      2610 non-null   float64
 14  UWHomes_TotalValue_Tier3      2610 non-null   float64
 15  UWHomes_TotalValue_AllTiers   2610 non-null   float64
 16  UWHomes_MedianValue_AllTiers  2610 non-null   float64
 17  AllHomes_Tier1_ShareUW        2610 non-null   float64
 18  AllHomes_Tier2_ShareUW        2610 non-null   float64
 19  AllHomes_Tier3_ShareUW        2610 non-null   float64
 20  AllHomes_AllTiers_ShareUW     2610 non-null   float64
 21  UWHomes_ShareInTier1          2610 non-null   float64
 22  UWHomes_ShareInTier2          2610 non-null   float64
 23  UWHomes_ShareInTier3          2610 non-null   float64
dtypes: float64(19), int64(1), object(4)
memory usage: 489.5+ KB
</pre></div>
</div>
</div>
</div>
<p>Once of the most important steps in data cleaning is just looking at what we have. What are the variables? What are their types? How many unique values of each variable do we have? Any missings? Do we see anything unexpected?</p>
<p>This <a class="reference external" href="https://datagy.io/pandas-unique/">page</a> has a nice summary.</p>
<p>We can select a column and change the variable type using <code class="docutils literal notranslate"><span class="pre">.astype()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uw</span><span class="p">[</span><span class="s1">&#39;UWHomes_Tier2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uw</span><span class="p">[</span><span class="s1">&#39;UWHomes_Tier2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This code is actually taking the column, changing its type, and saving it to the DataFrame with the same column name. Note that we could changed the name of the column.</p>
</section>
<section id="counting-missings-and-dupes">
<h2><span class="section-number">4.3.3. </span>Counting, missings, and dupes<a class="headerlink" href="#counting-missings-and-dupes" title="Permalink to this headline">#</a></h2>
<p>When you first bring in some data, you often want to do some simple checks. How many observations do you have? Are you missing anything? Are their duplicate observations? How do we define duplicate observations?</p>
<p>You can’t do any data analysis until you <strong>understand the structure of your data</strong>. What do you have? Why do you have it? How do you want to use it?</p>
<p>Let’s start with <strong>counts</strong>. We can count the number of times a <strong>category</strong> appears in a variable. Note that this is only useful for variables that have an sense of category. You would do this for any of the home count or dollar value variables, for example.</p>
<p>We can select a <strong>categorical variable</strong>, like <em>RegionType</em> and then use <code class="docutils literal notranslate"><span class="pre">.value_counts()</span></code> from <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uw</span><span class="p">[</span><span class="s1">&#39;RegionType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Zip       1247
City      1017
County     227
MSA         95
State       23
Nation       1
Name: RegionType, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We should look for <strong>missing values</strong> for each variable. <code class="docutils literal notranslate"><span class="pre">isna()</span></code> returns a <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> or <code class="docutils literal notranslate"><span class="pre">FALSE</span></code> for each value, depending on whether or not it is <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, or missing. We can then take those 1/0, true or false, values and add them up with <code class="docutils literal notranslate"><span class="pre">sum()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uw</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RegionType                         0
RegionName                         0
StateName                          1
MSAName                         1539
AllHomes_Tier1                     0
AllHomes_Tier2                     0
AllHomes_Tier3                     0
AllHomes_AllTiers                  0
UWHomes_Tier1                      0
UWHomes_Tier2                      0
UWHomes_Tier3                      0
UWHomes_AllTiers                   0
UWHomes_TotalValue_Tier1           0
UWHomes_TotalValue_Tier2           0
UWHomes_TotalValue_Tier3           0
UWHomes_TotalValue_AllTiers        0
UWHomes_MedianValue_AllTiers       0
AllHomes_Tier1_ShareUW             0
AllHomes_Tier2_ShareUW             0
AllHomes_Tier3_ShareUW             0
AllHomes_AllTiers_ShareUW          0
UWHomes_ShareInTier1               0
UWHomes_ShareInTier2               0
UWHomes_ShareInTier3               0
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>You can see the logic in how these functions work. We take our DataFrame uw and we send it to <code class="docutils literal notranslate"><span class="pre">isna()</span></code>. This actually creates another DataFrame, that we then pass to <code class="docutils literal notranslate"><span class="pre">sum()</span></code>. Check it out.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uw</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RegionType</th>
      <th>RegionName</th>
      <th>StateName</th>
      <th>MSAName</th>
      <th>AllHomes_Tier1</th>
      <th>AllHomes_Tier2</th>
      <th>AllHomes_Tier3</th>
      <th>AllHomes_AllTiers</th>
      <th>UWHomes_Tier1</th>
      <th>UWHomes_Tier2</th>
      <th>...</th>
      <th>UWHomes_TotalValue_Tier3</th>
      <th>UWHomes_TotalValue_AllTiers</th>
      <th>UWHomes_MedianValue_AllTiers</th>
      <th>AllHomes_Tier1_ShareUW</th>
      <th>AllHomes_Tier2_ShareUW</th>
      <th>AllHomes_Tier3_ShareUW</th>
      <th>AllHomes_AllTiers_ShareUW</th>
      <th>UWHomes_ShareInTier1</th>
      <th>UWHomes_ShareInTier2</th>
      <th>UWHomes_ShareInTier3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2605</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2606</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2607</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2608</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2609</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>2610 rows × 24 columns</p>
</div></div></div>
</div>
<p>The same sort of logic applies to the method <code class="docutils literal notranslate"><span class="pre">unique()</span></code>. This one gives an <code class="docutils literal notranslate"><span class="pre">array</span></code> of each unique value in a column or set of columns. This will save an array of unique values that appear in the <em>RegionName</em> column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unique_regions</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">RegionName</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>I’m using the <code class="docutils literal notranslate"><span class="pre">.ColumnName</span></code> construction to pull the variable.</p>
<p>We can count the number of unique values for a variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uw</span><span class="o">.</span><span class="n">RegionName</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2496
</pre></div>
</div>
</div>
</div>
<p>We can filter on one variable and count another. We’re looking for unexpected things, just trying to get a sense for what we have.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uw</span><span class="p">[</span><span class="n">uw</span><span class="p">[</span><span class="s1">&#39;RegionType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MSA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">MSAName</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95
</pre></div>
</div>
</div>
</div>
<p>This syntax works too! We are pulling the column name out using a <strong>list</strong> defined by the column names inside of <code class="docutils literal notranslate"><span class="pre">[]</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uw</span><span class="p">[</span><span class="n">uw</span><span class="p">[</span><span class="s1">&#39;RegionType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MSA&#39;</span><span class="p">][</span><span class="s1">&#39;MSAName&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95
</pre></div>
</div>
</div>
</div>
<p>We have 95 unique MSA is our data. Seems reasonable. MSAs are like city-regions.</p>
<p>Finally, we can just drop any rows with missing values using <code class="docutils literal notranslate"><span class="pre">.dropna()</span></code> from <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. If we don’t specify a column, then it will drop a row if <strong>ANY</strong> value is missing. I don’t actually want to drop missings here, so I’m not going to save my work with a <code class="docutils literal notranslate"><span class="pre">uw</span> <span class="pre">=</span> </code>.</p>
<p>You can read more <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.dropna.html">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uw</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RegionType</th>
      <th>RegionName</th>
      <th>StateName</th>
      <th>MSAName</th>
      <th>AllHomes_Tier1</th>
      <th>AllHomes_Tier2</th>
      <th>AllHomes_Tier3</th>
      <th>AllHomes_AllTiers</th>
      <th>UWHomes_Tier1</th>
      <th>UWHomes_Tier2</th>
      <th>...</th>
      <th>UWHomes_TotalValue_Tier3</th>
      <th>UWHomes_TotalValue_AllTiers</th>
      <th>UWHomes_MedianValue_AllTiers</th>
      <th>AllHomes_Tier1_ShareUW</th>
      <th>AllHomes_Tier2_ShareUW</th>
      <th>AllHomes_Tier3_ShareUW</th>
      <th>AllHomes_AllTiers_ShareUW</th>
      <th>UWHomes_ShareInTier1</th>
      <th>UWHomes_ShareInTier2</th>
      <th>UWHomes_ShareInTier3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>251</th>
      <td>MSA</td>
      <td>Aberdeen, WA</td>
      <td>Washington</td>
      <td>Aberdeen, WA</td>
      <td>11606.0</td>
      <td>11751.0</td>
      <td>11749.0</td>
      <td>35106.0</td>
      <td>4119.0</td>
      <td>2450.0</td>
      <td>...</td>
      <td>1.734113e+08</td>
      <td>7.791588e+08</td>
      <td>88327.0</td>
      <td>0.354903</td>
      <td>0.208493</td>
      <td>0.065537</td>
      <td>0.209053</td>
      <td>0.561248</td>
      <td>0.333833</td>
      <td>0.104919</td>
    </tr>
    <tr>
      <th>252</th>
      <td>MSA</td>
      <td>Astoria, OR</td>
      <td>Oregon</td>
      <td>Astoria, OR</td>
      <td>4745.0</td>
      <td>5228.0</td>
      <td>5568.0</td>
      <td>15541.0</td>
      <td>811.0</td>
      <td>376.0</td>
      <td>...</td>
      <td>9.138231e+07</td>
      <td>3.620604e+08</td>
      <td>237912.0</td>
      <td>0.170917</td>
      <td>0.071920</td>
      <td>0.040409</td>
      <td>0.090856</td>
      <td>0.574363</td>
      <td>0.266289</td>
      <td>0.159348</td>
    </tr>
    <tr>
      <th>253</th>
      <td>MSA</td>
      <td>Egg Harbor Township, NJ</td>
      <td>New Jersey</td>
      <td>Egg Harbor Township, NJ</td>
      <td>34185.0</td>
      <td>34117.0</td>
      <td>34088.0</td>
      <td>102390.0</td>
      <td>9116.0</td>
      <td>9575.0</td>
      <td>...</td>
      <td>5.576646e+09</td>
      <td>1.030631e+10</td>
      <td>264441.0</td>
      <td>0.266667</td>
      <td>0.280652</td>
      <td>0.252200</td>
      <td>0.266510</td>
      <td>0.334066</td>
      <td>0.350887</td>
      <td>0.315047</td>
    </tr>
    <tr>
      <th>254</th>
      <td>MSA</td>
      <td>Baltimore, MD</td>
      <td>Maryland</td>
      <td>Baltimore, MD</td>
      <td>298318.0</td>
      <td>312603.0</td>
      <td>316502.0</td>
      <td>927423.0</td>
      <td>2293.0</td>
      <td>2910.0</td>
      <td>...</td>
      <td>3.698818e+09</td>
      <td>5.153664e+09</td>
      <td>336801.0</td>
      <td>0.007686</td>
      <td>0.009309</td>
      <td>0.021861</td>
      <td>0.013071</td>
      <td>0.189160</td>
      <td>0.240059</td>
      <td>0.570780</td>
    </tr>
    <tr>
      <th>255</th>
      <td>MSA</td>
      <td>East Falmouth, MA</td>
      <td>Massachusetts</td>
      <td>East Falmouth, MA</td>
      <td>45345.0</td>
      <td>45358.0</td>
      <td>45258.0</td>
      <td>135961.0</td>
      <td>1651.0</td>
      <td>1395.0</td>
      <td>...</td>
      <td>4.205784e+09</td>
      <td>5.349099e+09</td>
      <td>588650.0</td>
      <td>0.036410</td>
      <td>0.030755</td>
      <td>0.073004</td>
      <td>0.046705</td>
      <td>0.260000</td>
      <td>0.219685</td>
      <td>0.520315</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1358</th>
      <td>City</td>
      <td>Town of Salisbury</td>
      <td>Massachusetts</td>
      <td>Boston, MA</td>
      <td>1207.0</td>
      <td>1207.0</td>
      <td>1207.0</td>
      <td>3621.0</td>
      <td>397.0</td>
      <td>402.0</td>
      <td>...</td>
      <td>1.484370e+08</td>
      <td>3.900701e+08</td>
      <td>342026.0</td>
      <td>0.328915</td>
      <td>0.333057</td>
      <td>0.221210</td>
      <td>0.294394</td>
      <td>0.372420</td>
      <td>0.377111</td>
      <td>0.250469</td>
    </tr>
    <tr>
      <th>1359</th>
      <td>City</td>
      <td>Town of Duxbury</td>
      <td>Massachusetts</td>
      <td>Boston, MA</td>
      <td>1835.0</td>
      <td>1835.0</td>
      <td>1837.0</td>
      <td>5507.0</td>
      <td>68.0</td>
      <td>33.0</td>
      <td>...</td>
      <td>1.909504e+08</td>
      <td>2.389202e+08</td>
      <td>749341.0</td>
      <td>0.037057</td>
      <td>0.017984</td>
      <td>0.056614</td>
      <td>0.037225</td>
      <td>0.331707</td>
      <td>0.160976</td>
      <td>0.507317</td>
    </tr>
    <tr>
      <th>1360</th>
      <td>City</td>
      <td>New Shoreham</td>
      <td>Rhode Island</td>
      <td>Providence, RI</td>
      <td>506.0</td>
      <td>506.0</td>
      <td>506.0</td>
      <td>1518.0</td>
      <td>57.0</td>
      <td>25.0</td>
      <td>...</td>
      <td>9.383493e+07</td>
      <td>1.654886e+08</td>
      <td>1072092.0</td>
      <td>0.112648</td>
      <td>0.049407</td>
      <td>0.094862</td>
      <td>0.085639</td>
      <td>0.438462</td>
      <td>0.192308</td>
      <td>0.369231</td>
    </tr>
    <tr>
      <th>1361</th>
      <td>City</td>
      <td>Yarmouth</td>
      <td>Massachusetts</td>
      <td>East Falmouth, MA</td>
      <td>5178.0</td>
      <td>5178.0</td>
      <td>5180.0</td>
      <td>15536.0</td>
      <td>472.0</td>
      <td>184.0</td>
      <td>...</td>
      <td>4.531706e+08</td>
      <td>6.061486e+08</td>
      <td>332409.0</td>
      <td>0.091155</td>
      <td>0.035535</td>
      <td>0.102124</td>
      <td>0.076274</td>
      <td>0.398312</td>
      <td>0.155274</td>
      <td>0.446414</td>
    </tr>
    <tr>
      <th>1362</th>
      <td>City</td>
      <td>Town of Hingham</td>
      <td>Massachusetts</td>
      <td>Boston, MA</td>
      <td>2462.0</td>
      <td>2462.0</td>
      <td>2462.0</td>
      <td>7386.0</td>
      <td>48.0</td>
      <td>33.0</td>
      <td>...</td>
      <td>8.266223e+07</td>
      <td>1.309589e+08</td>
      <td>731420.0</td>
      <td>0.019496</td>
      <td>0.013404</td>
      <td>0.021121</td>
      <td>0.018007</td>
      <td>0.360902</td>
      <td>0.248120</td>
      <td>0.390977</td>
    </tr>
  </tbody>
</table>
<p>1071 rows × 24 columns</p>
</div></div></div>
</div>
<p>We now have 1071 rows, since <em>MSAName</em> had so many missing values. But - that was OK given how this data are constructed. You’ll see another example with stock data below.</p>
<p>Now, I’ll just drop observations if <em>AllHomes_Tier1</em> is missing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uw</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AllHomes_Tier1&#39;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RegionType</th>
      <th>RegionName</th>
      <th>StateName</th>
      <th>MSAName</th>
      <th>AllHomes_Tier1</th>
      <th>AllHomes_Tier2</th>
      <th>AllHomes_Tier3</th>
      <th>AllHomes_AllTiers</th>
      <th>UWHomes_Tier1</th>
      <th>UWHomes_Tier2</th>
      <th>...</th>
      <th>UWHomes_TotalValue_Tier3</th>
      <th>UWHomes_TotalValue_AllTiers</th>
      <th>UWHomes_MedianValue_AllTiers</th>
      <th>AllHomes_Tier1_ShareUW</th>
      <th>AllHomes_Tier2_ShareUW</th>
      <th>AllHomes_Tier3_ShareUW</th>
      <th>AllHomes_AllTiers_ShareUW</th>
      <th>UWHomes_ShareInTier1</th>
      <th>UWHomes_ShareInTier2</th>
      <th>UWHomes_ShareInTier3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Nation</td>
      <td>United States</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>35461549.0</td>
      <td>35452941.0</td>
      <td>35484532.0</td>
      <td>106399022.0</td>
      <td>594672.0</td>
      <td>542681.0</td>
      <td>...</td>
      <td>5.974490e+11</td>
      <td>9.159540e+11</td>
      <td>310306.0</td>
      <td>0.016769</td>
      <td>0.015307</td>
      <td>0.020458</td>
      <td>0.017512</td>
      <td>0.319149</td>
      <td>0.291246</td>
      <td>0.389605</td>
    </tr>
    <tr>
      <th>1</th>
      <td>State</td>
      <td>Alabama</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>546670.0</td>
      <td>520247.0</td>
      <td>491300.0</td>
      <td>1558217.0</td>
      <td>2890.0</td>
      <td>2766.0</td>
      <td>...</td>
      <td>2.583039e+09</td>
      <td>3.578203e+09</td>
      <td>270254.0</td>
      <td>0.005287</td>
      <td>0.005317</td>
      <td>0.010271</td>
      <td>0.006868</td>
      <td>0.270043</td>
      <td>0.258456</td>
      <td>0.471501</td>
    </tr>
    <tr>
      <th>2</th>
      <td>State</td>
      <td>California</td>
      <td>California</td>
      <td>NaN</td>
      <td>3060171.0</td>
      <td>3076238.0</td>
      <td>3169584.0</td>
      <td>9305993.0</td>
      <td>8090.0</td>
      <td>14266.0</td>
      <td>...</td>
      <td>2.666638e+10</td>
      <td>4.449536e+10</td>
      <td>860373.0</td>
      <td>0.002644</td>
      <td>0.004637</td>
      <td>0.005611</td>
      <td>0.004313</td>
      <td>0.201550</td>
      <td>0.355415</td>
      <td>0.443035</td>
    </tr>
    <tr>
      <th>3</th>
      <td>State</td>
      <td>Connecticut</td>
      <td>Connecticut</td>
      <td>NaN</td>
      <td>333904.0</td>
      <td>334688.0</td>
      <td>336254.0</td>
      <td>1004846.0</td>
      <td>4434.0</td>
      <td>3807.0</td>
      <td>...</td>
      <td>8.689480e+09</td>
      <td>1.152170e+10</td>
      <td>442036.0</td>
      <td>0.013279</td>
      <td>0.011375</td>
      <td>0.021677</td>
      <td>0.015455</td>
      <td>0.285512</td>
      <td>0.245138</td>
      <td>0.469350</td>
    </tr>
    <tr>
      <th>4</th>
      <td>State</td>
      <td>Delaware</td>
      <td>Delaware</td>
      <td>NaN</td>
      <td>102983.0</td>
      <td>127573.0</td>
      <td>127983.0</td>
      <td>358539.0</td>
      <td>4105.0</td>
      <td>2574.0</td>
      <td>...</td>
      <td>1.498013e+09</td>
      <td>2.801847e+09</td>
      <td>241344.5</td>
      <td>0.039861</td>
      <td>0.020177</td>
      <td>0.025675</td>
      <td>0.027793</td>
      <td>0.411942</td>
      <td>0.258304</td>
      <td>0.329754</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2605</th>
      <td>Zip</td>
      <td>98592</td>
      <td>Washington</td>
      <td>NaN</td>
      <td>464.0</td>
      <td>470.0</td>
      <td>493.0</td>
      <td>1427.0</td>
      <td>8.0</td>
      <td>29.0</td>
      <td>...</td>
      <td>7.340711e+07</td>
      <td>8.271541e+07</td>
      <td>436490.5</td>
      <td>0.017241</td>
      <td>0.061702</td>
      <td>0.273834</td>
      <td>0.120533</td>
      <td>0.046512</td>
      <td>0.168605</td>
      <td>0.784884</td>
    </tr>
    <tr>
      <th>2606</th>
      <td>Zip</td>
      <td>98595</td>
      <td>Washington</td>
      <td>NaN</td>
      <td>558.0</td>
      <td>571.0</td>
      <td>598.0</td>
      <td>1727.0</td>
      <td>119.0</td>
      <td>104.0</td>
      <td>...</td>
      <td>1.376119e+07</td>
      <td>4.036570e+07</td>
      <td>131441.0</td>
      <td>0.213262</td>
      <td>0.182137</td>
      <td>0.095318</td>
      <td>0.162131</td>
      <td>0.425000</td>
      <td>0.371429</td>
      <td>0.203571</td>
    </tr>
    <tr>
      <th>2607</th>
      <td>Zip</td>
      <td>98612</td>
      <td>Washington</td>
      <td>NaN</td>
      <td>365.0</td>
      <td>376.0</td>
      <td>409.0</td>
      <td>1150.0</td>
      <td>91.0</td>
      <td>79.0</td>
      <td>...</td>
      <td>1.440674e+07</td>
      <td>5.028400e+07</td>
      <td>230495.0</td>
      <td>0.249315</td>
      <td>0.210106</td>
      <td>0.092910</td>
      <td>0.180870</td>
      <td>0.437500</td>
      <td>0.379808</td>
      <td>0.182692</td>
    </tr>
    <tr>
      <th>2608</th>
      <td>Zip</td>
      <td>32081</td>
      <td>Florida</td>
      <td>NaN</td>
      <td>1318.0</td>
      <td>1328.0</td>
      <td>1350.0</td>
      <td>3996.0</td>
      <td>91.0</td>
      <td>42.0</td>
      <td>...</td>
      <td>9.111212e+07</td>
      <td>1.325055e+08</td>
      <td>385196.0</td>
      <td>0.069044</td>
      <td>0.031627</td>
      <td>0.097778</td>
      <td>0.066316</td>
      <td>0.343396</td>
      <td>0.158491</td>
      <td>0.498113</td>
    </tr>
    <tr>
      <th>2609</th>
      <td>Zip</td>
      <td>33578</td>
      <td>Florida</td>
      <td>NaN</td>
      <td>5975.0</td>
      <td>4537.0</td>
      <td>3232.0</td>
      <td>13744.0</td>
      <td>8.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>5.685202e+07</td>
      <td>5.911551e+07</td>
      <td>363355.0</td>
      <td>0.001339</td>
      <td>0.001322</td>
      <td>0.038366</td>
      <td>0.010041</td>
      <td>0.057971</td>
      <td>0.043478</td>
      <td>0.898551</td>
    </tr>
  </tbody>
</table>
<p>2610 rows × 24 columns</p>
</div></div></div>
</div>
<p>Nothing gets dropped, since there were no missing values.</p>
<p>Unique and missing values are important. So is the idea of <strong>duplicates</strong>. Does a row (an observation) contain the same values as another row? That could be all of the values across all of the variables, or just a particular column (e.g. ticker), or a set of columns (e.g. ticker and date).</p>
<p>We can see if our data has any duplicates by using <code class="docutils literal notranslate"><span class="pre">.duplicated()</span></code> from <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.</p>
<p>You can read more <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.duplicated.html">here</a>.</p>
<p>I’m going to <strong>filter</strong> my data to only include <code class="docutils literal notranslate"><span class="pre">RegionType='Zip'</span></code> and then look for duplicate Zip codes. The Zip codes are found in <em>RegionName</em>. I’ll save this to a new DataFrame called <em>dupes</em>. The argument <code class="docutils literal notranslate"><span class="pre">keep='first</span></code> will keep the first duplicate, if any.</p>
<p>I am then going to <strong>mask</strong> my subset of the uw data. So, I filter to get just Zip codes. Then, I <strong>mask</strong> on the <em>dupes</em> DataFrame. This DataFrame is just an array of True/False values. By <strong>masking</strong>, I’m telling Python to only keep values that are True. There are no True values, so no duplicate Zips and the resulting DataFrame is empty.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dupes</span> <span class="o">=</span> <span class="n">uw</span><span class="p">[</span><span class="n">uw</span><span class="p">[</span><span class="s1">&#39;RegionType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Zip&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RegionName&#39;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>

<span class="n">uw</span><span class="p">[</span><span class="n">uw</span><span class="p">[</span><span class="s1">&#39;RegionType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Zip&#39;</span><span class="p">][</span><span class="n">dupes</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RegionType</th>
      <th>RegionName</th>
      <th>StateName</th>
      <th>MSAName</th>
      <th>AllHomes_Tier1</th>
      <th>AllHomes_Tier2</th>
      <th>AllHomes_Tier3</th>
      <th>AllHomes_AllTiers</th>
      <th>UWHomes_Tier1</th>
      <th>UWHomes_Tier2</th>
      <th>...</th>
      <th>UWHomes_TotalValue_Tier3</th>
      <th>UWHomes_TotalValue_AllTiers</th>
      <th>UWHomes_MedianValue_AllTiers</th>
      <th>AllHomes_Tier1_ShareUW</th>
      <th>AllHomes_Tier2_ShareUW</th>
      <th>AllHomes_Tier3_ShareUW</th>
      <th>AllHomes_AllTiers_ShareUW</th>
      <th>UWHomes_ShareInTier1</th>
      <th>UWHomes_ShareInTier2</th>
      <th>UWHomes_ShareInTier3</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<p>0 rows × 24 columns</p>
</div></div></div>
</div>
<p>We can use <code class="docutils literal notranslate"><span class="pre">drop_duplicates()</span></code> to look at our data and drop rows that are duplicate observations. We use the <code class="docutils literal notranslate"><span class="pre">subset=</span></code> argument to tell it what columns to look at for duplicates. We can leave out this argument if we want to look across all columns.</p>
<p>The argument <code class="docutils literal notranslate"><span class="pre">keep=</span></code> will tell it which duplicate to keep in the data (e.g. the first one or the last one).</p>
<p>You can read more about the syntax <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.drop_duplicates.html">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uw</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RegionType</th>
      <th>RegionName</th>
      <th>StateName</th>
      <th>MSAName</th>
      <th>AllHomes_Tier1</th>
      <th>AllHomes_Tier2</th>
      <th>AllHomes_Tier3</th>
      <th>AllHomes_AllTiers</th>
      <th>UWHomes_Tier1</th>
      <th>UWHomes_Tier2</th>
      <th>...</th>
      <th>UWHomes_TotalValue_Tier3</th>
      <th>UWHomes_TotalValue_AllTiers</th>
      <th>UWHomes_MedianValue_AllTiers</th>
      <th>AllHomes_Tier1_ShareUW</th>
      <th>AllHomes_Tier2_ShareUW</th>
      <th>AllHomes_Tier3_ShareUW</th>
      <th>AllHomes_AllTiers_ShareUW</th>
      <th>UWHomes_ShareInTier1</th>
      <th>UWHomes_ShareInTier2</th>
      <th>UWHomes_ShareInTier3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Nation</td>
      <td>United States</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>35461549.0</td>
      <td>35452941.0</td>
      <td>35484532.0</td>
      <td>106399022.0</td>
      <td>594672.0</td>
      <td>542681.0</td>
      <td>...</td>
      <td>5.974490e+11</td>
      <td>9.159540e+11</td>
      <td>310306.0</td>
      <td>0.016769</td>
      <td>0.015307</td>
      <td>0.020458</td>
      <td>0.017512</td>
      <td>0.319149</td>
      <td>0.291246</td>
      <td>0.389605</td>
    </tr>
    <tr>
      <th>1</th>
      <td>State</td>
      <td>Alabama</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>546670.0</td>
      <td>520247.0</td>
      <td>491300.0</td>
      <td>1558217.0</td>
      <td>2890.0</td>
      <td>2766.0</td>
      <td>...</td>
      <td>2.583039e+09</td>
      <td>3.578203e+09</td>
      <td>270254.0</td>
      <td>0.005287</td>
      <td>0.005317</td>
      <td>0.010271</td>
      <td>0.006868</td>
      <td>0.270043</td>
      <td>0.258456</td>
      <td>0.471501</td>
    </tr>
    <tr>
      <th>2</th>
      <td>State</td>
      <td>California</td>
      <td>California</td>
      <td>NaN</td>
      <td>3060171.0</td>
      <td>3076238.0</td>
      <td>3169584.0</td>
      <td>9305993.0</td>
      <td>8090.0</td>
      <td>14266.0</td>
      <td>...</td>
      <td>2.666638e+10</td>
      <td>4.449536e+10</td>
      <td>860373.0</td>
      <td>0.002644</td>
      <td>0.004637</td>
      <td>0.005611</td>
      <td>0.004313</td>
      <td>0.201550</td>
      <td>0.355415</td>
      <td>0.443035</td>
    </tr>
    <tr>
      <th>3</th>
      <td>State</td>
      <td>Connecticut</td>
      <td>Connecticut</td>
      <td>NaN</td>
      <td>333904.0</td>
      <td>334688.0</td>
      <td>336254.0</td>
      <td>1004846.0</td>
      <td>4434.0</td>
      <td>3807.0</td>
      <td>...</td>
      <td>8.689480e+09</td>
      <td>1.152170e+10</td>
      <td>442036.0</td>
      <td>0.013279</td>
      <td>0.011375</td>
      <td>0.021677</td>
      <td>0.015455</td>
      <td>0.285512</td>
      <td>0.245138</td>
      <td>0.469350</td>
    </tr>
    <tr>
      <th>4</th>
      <td>State</td>
      <td>Delaware</td>
      <td>Delaware</td>
      <td>NaN</td>
      <td>102983.0</td>
      <td>127573.0</td>
      <td>127983.0</td>
      <td>358539.0</td>
      <td>4105.0</td>
      <td>2574.0</td>
      <td>...</td>
      <td>1.498013e+09</td>
      <td>2.801847e+09</td>
      <td>241344.5</td>
      <td>0.039861</td>
      <td>0.020177</td>
      <td>0.025675</td>
      <td>0.027793</td>
      <td>0.411942</td>
      <td>0.258304</td>
      <td>0.329754</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2605</th>
      <td>Zip</td>
      <td>98592</td>
      <td>Washington</td>
      <td>NaN</td>
      <td>464.0</td>
      <td>470.0</td>
      <td>493.0</td>
      <td>1427.0</td>
      <td>8.0</td>
      <td>29.0</td>
      <td>...</td>
      <td>7.340711e+07</td>
      <td>8.271541e+07</td>
      <td>436490.5</td>
      <td>0.017241</td>
      <td>0.061702</td>
      <td>0.273834</td>
      <td>0.120533</td>
      <td>0.046512</td>
      <td>0.168605</td>
      <td>0.784884</td>
    </tr>
    <tr>
      <th>2606</th>
      <td>Zip</td>
      <td>98595</td>
      <td>Washington</td>
      <td>NaN</td>
      <td>558.0</td>
      <td>571.0</td>
      <td>598.0</td>
      <td>1727.0</td>
      <td>119.0</td>
      <td>104.0</td>
      <td>...</td>
      <td>1.376119e+07</td>
      <td>4.036570e+07</td>
      <td>131441.0</td>
      <td>0.213262</td>
      <td>0.182137</td>
      <td>0.095318</td>
      <td>0.162131</td>
      <td>0.425000</td>
      <td>0.371429</td>
      <td>0.203571</td>
    </tr>
    <tr>
      <th>2607</th>
      <td>Zip</td>
      <td>98612</td>
      <td>Washington</td>
      <td>NaN</td>
      <td>365.0</td>
      <td>376.0</td>
      <td>409.0</td>
      <td>1150.0</td>
      <td>91.0</td>
      <td>79.0</td>
      <td>...</td>
      <td>1.440674e+07</td>
      <td>5.028400e+07</td>
      <td>230495.0</td>
      <td>0.249315</td>
      <td>0.210106</td>
      <td>0.092910</td>
      <td>0.180870</td>
      <td>0.437500</td>
      <td>0.379808</td>
      <td>0.182692</td>
    </tr>
    <tr>
      <th>2608</th>
      <td>Zip</td>
      <td>32081</td>
      <td>Florida</td>
      <td>NaN</td>
      <td>1318.0</td>
      <td>1328.0</td>
      <td>1350.0</td>
      <td>3996.0</td>
      <td>91.0</td>
      <td>42.0</td>
      <td>...</td>
      <td>9.111212e+07</td>
      <td>1.325055e+08</td>
      <td>385196.0</td>
      <td>0.069044</td>
      <td>0.031627</td>
      <td>0.097778</td>
      <td>0.066316</td>
      <td>0.343396</td>
      <td>0.158491</td>
      <td>0.498113</td>
    </tr>
    <tr>
      <th>2609</th>
      <td>Zip</td>
      <td>33578</td>
      <td>Florida</td>
      <td>NaN</td>
      <td>5975.0</td>
      <td>4537.0</td>
      <td>3232.0</td>
      <td>13744.0</td>
      <td>8.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>5.685202e+07</td>
      <td>5.911551e+07</td>
      <td>363355.0</td>
      <td>0.001339</td>
      <td>0.001322</td>
      <td>0.038366</td>
      <td>0.010041</td>
      <td>0.057971</td>
      <td>0.043478</td>
      <td>0.898551</td>
    </tr>
  </tbody>
</table>
<p>2610 rows × 24 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uw</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RegionName&#39;</span><span class="p">,</span> <span class="s1">&#39;StateName&#39;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RegionType</th>
      <th>RegionName</th>
      <th>StateName</th>
      <th>MSAName</th>
      <th>AllHomes_Tier1</th>
      <th>AllHomes_Tier2</th>
      <th>AllHomes_Tier3</th>
      <th>AllHomes_AllTiers</th>
      <th>UWHomes_Tier1</th>
      <th>UWHomes_Tier2</th>
      <th>...</th>
      <th>UWHomes_TotalValue_Tier3</th>
      <th>UWHomes_TotalValue_AllTiers</th>
      <th>UWHomes_MedianValue_AllTiers</th>
      <th>AllHomes_Tier1_ShareUW</th>
      <th>AllHomes_Tier2_ShareUW</th>
      <th>AllHomes_Tier3_ShareUW</th>
      <th>AllHomes_AllTiers_ShareUW</th>
      <th>UWHomes_ShareInTier1</th>
      <th>UWHomes_ShareInTier2</th>
      <th>UWHomes_ShareInTier3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Nation</td>
      <td>United States</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>35461549.0</td>
      <td>35452941.0</td>
      <td>35484532.0</td>
      <td>106399022.0</td>
      <td>594672.0</td>
      <td>542681.0</td>
      <td>...</td>
      <td>5.974490e+11</td>
      <td>9.159540e+11</td>
      <td>310306.0</td>
      <td>0.016769</td>
      <td>0.015307</td>
      <td>0.020458</td>
      <td>0.017512</td>
      <td>0.319149</td>
      <td>0.291246</td>
      <td>0.389605</td>
    </tr>
    <tr>
      <th>1</th>
      <td>State</td>
      <td>Alabama</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>546670.0</td>
      <td>520247.0</td>
      <td>491300.0</td>
      <td>1558217.0</td>
      <td>2890.0</td>
      <td>2766.0</td>
      <td>...</td>
      <td>2.583039e+09</td>
      <td>3.578203e+09</td>
      <td>270254.0</td>
      <td>0.005287</td>
      <td>0.005317</td>
      <td>0.010271</td>
      <td>0.006868</td>
      <td>0.270043</td>
      <td>0.258456</td>
      <td>0.471501</td>
    </tr>
    <tr>
      <th>2</th>
      <td>State</td>
      <td>California</td>
      <td>California</td>
      <td>NaN</td>
      <td>3060171.0</td>
      <td>3076238.0</td>
      <td>3169584.0</td>
      <td>9305993.0</td>
      <td>8090.0</td>
      <td>14266.0</td>
      <td>...</td>
      <td>2.666638e+10</td>
      <td>4.449536e+10</td>
      <td>860373.0</td>
      <td>0.002644</td>
      <td>0.004637</td>
      <td>0.005611</td>
      <td>0.004313</td>
      <td>0.201550</td>
      <td>0.355415</td>
      <td>0.443035</td>
    </tr>
    <tr>
      <th>3</th>
      <td>State</td>
      <td>Connecticut</td>
      <td>Connecticut</td>
      <td>NaN</td>
      <td>333904.0</td>
      <td>334688.0</td>
      <td>336254.0</td>
      <td>1004846.0</td>
      <td>4434.0</td>
      <td>3807.0</td>
      <td>...</td>
      <td>8.689480e+09</td>
      <td>1.152170e+10</td>
      <td>442036.0</td>
      <td>0.013279</td>
      <td>0.011375</td>
      <td>0.021677</td>
      <td>0.015455</td>
      <td>0.285512</td>
      <td>0.245138</td>
      <td>0.469350</td>
    </tr>
    <tr>
      <th>4</th>
      <td>State</td>
      <td>Delaware</td>
      <td>Delaware</td>
      <td>NaN</td>
      <td>102983.0</td>
      <td>127573.0</td>
      <td>127983.0</td>
      <td>358539.0</td>
      <td>4105.0</td>
      <td>2574.0</td>
      <td>...</td>
      <td>1.498013e+09</td>
      <td>2.801847e+09</td>
      <td>241344.5</td>
      <td>0.039861</td>
      <td>0.020177</td>
      <td>0.025675</td>
      <td>0.027793</td>
      <td>0.411942</td>
      <td>0.258304</td>
      <td>0.329754</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2605</th>
      <td>Zip</td>
      <td>98592</td>
      <td>Washington</td>
      <td>NaN</td>
      <td>464.0</td>
      <td>470.0</td>
      <td>493.0</td>
      <td>1427.0</td>
      <td>8.0</td>
      <td>29.0</td>
      <td>...</td>
      <td>7.340711e+07</td>
      <td>8.271541e+07</td>
      <td>436490.5</td>
      <td>0.017241</td>
      <td>0.061702</td>
      <td>0.273834</td>
      <td>0.120533</td>
      <td>0.046512</td>
      <td>0.168605</td>
      <td>0.784884</td>
    </tr>
    <tr>
      <th>2606</th>
      <td>Zip</td>
      <td>98595</td>
      <td>Washington</td>
      <td>NaN</td>
      <td>558.0</td>
      <td>571.0</td>
      <td>598.0</td>
      <td>1727.0</td>
      <td>119.0</td>
      <td>104.0</td>
      <td>...</td>
      <td>1.376119e+07</td>
      <td>4.036570e+07</td>
      <td>131441.0</td>
      <td>0.213262</td>
      <td>0.182137</td>
      <td>0.095318</td>
      <td>0.162131</td>
      <td>0.425000</td>
      <td>0.371429</td>
      <td>0.203571</td>
    </tr>
    <tr>
      <th>2607</th>
      <td>Zip</td>
      <td>98612</td>
      <td>Washington</td>
      <td>NaN</td>
      <td>365.0</td>
      <td>376.0</td>
      <td>409.0</td>
      <td>1150.0</td>
      <td>91.0</td>
      <td>79.0</td>
      <td>...</td>
      <td>1.440674e+07</td>
      <td>5.028400e+07</td>
      <td>230495.0</td>
      <td>0.249315</td>
      <td>0.210106</td>
      <td>0.092910</td>
      <td>0.180870</td>
      <td>0.437500</td>
      <td>0.379808</td>
      <td>0.182692</td>
    </tr>
    <tr>
      <th>2608</th>
      <td>Zip</td>
      <td>32081</td>
      <td>Florida</td>
      <td>NaN</td>
      <td>1318.0</td>
      <td>1328.0</td>
      <td>1350.0</td>
      <td>3996.0</td>
      <td>91.0</td>
      <td>42.0</td>
      <td>...</td>
      <td>9.111212e+07</td>
      <td>1.325055e+08</td>
      <td>385196.0</td>
      <td>0.069044</td>
      <td>0.031627</td>
      <td>0.097778</td>
      <td>0.066316</td>
      <td>0.343396</td>
      <td>0.158491</td>
      <td>0.498113</td>
    </tr>
    <tr>
      <th>2609</th>
      <td>Zip</td>
      <td>33578</td>
      <td>Florida</td>
      <td>NaN</td>
      <td>5975.0</td>
      <td>4537.0</td>
      <td>3232.0</td>
      <td>13744.0</td>
      <td>8.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>5.685202e+07</td>
      <td>5.911551e+07</td>
      <td>363355.0</td>
      <td>0.001339</td>
      <td>0.001322</td>
      <td>0.038366</td>
      <td>0.010041</td>
      <td>0.057971</td>
      <td>0.043478</td>
      <td>0.898551</td>
    </tr>
  </tbody>
</table>
<p>2571 rows × 24 columns</p>
</div></div></div>
</div>
<p>You want to keep track of the number of observations (rows) when you’re dropping duplicates. In this case, we go from 2,610 rows to 2,571.</p>
</section>
<section id="sorting-our-data">
<h2><span class="section-number">4.3.4. </span>Sorting our data<a class="headerlink" href="#sorting-our-data" title="Permalink to this headline">#</a></h2>
<p>Another basic task that we often face is <strong>sorting our data</strong>. You can sort numeric or string data, by variable using <code class="docutils literal notranslate"><span class="pre">.sort_values()</span></code> from <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ascending=</span></code> argument can be True or False and tells us how to sort. You can pass it a list of how to sort if you’re sorting on multiple variables.</p>
<p>I’l sort the data by <em>RegionType</em> first. Then, I’ll sort the data by <em>RegionType</em>, <em>RegionName</em>, and <em>AllHomes_Tier1</em></p>
<p>You can read more <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.sort_values.html">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uw</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;RegionType&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RegionType</th>
      <th>RegionName</th>
      <th>StateName</th>
      <th>MSAName</th>
      <th>AllHomes_Tier1</th>
      <th>AllHomes_Tier2</th>
      <th>AllHomes_Tier3</th>
      <th>AllHomes_AllTiers</th>
      <th>UWHomes_Tier1</th>
      <th>UWHomes_Tier2</th>
      <th>...</th>
      <th>UWHomes_TotalValue_Tier3</th>
      <th>UWHomes_TotalValue_AllTiers</th>
      <th>UWHomes_MedianValue_AllTiers</th>
      <th>AllHomes_Tier1_ShareUW</th>
      <th>AllHomes_Tier2_ShareUW</th>
      <th>AllHomes_Tier3_ShareUW</th>
      <th>AllHomes_AllTiers_ShareUW</th>
      <th>UWHomes_ShareInTier1</th>
      <th>UWHomes_ShareInTier2</th>
      <th>UWHomes_ShareInTier3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1304</th>
      <td>City</td>
      <td>Ortley Beach</td>
      <td>New Jersey</td>
      <td>New York, NY</td>
      <td>767.0</td>
      <td>763.0</td>
      <td>766.0</td>
      <td>2296.0</td>
      <td>746.0</td>
      <td>724.0</td>
      <td>...</td>
      <td>447937059.0</td>
      <td>879315914.0</td>
      <td>348092.0</td>
      <td>0.972621</td>
      <td>0.948886</td>
      <td>0.953003</td>
      <td>0.958188</td>
      <td>0.339091</td>
      <td>0.329091</td>
      <td>0.331818</td>
    </tr>
    <tr>
      <th>896</th>
      <td>City</td>
      <td>Smyrna</td>
      <td>Delaware</td>
      <td>Dover, DE</td>
      <td>4464.0</td>
      <td>4464.0</td>
      <td>4464.0</td>
      <td>13392.0</td>
      <td>128.0</td>
      <td>39.0</td>
      <td>...</td>
      <td>9078029.0</td>
      <td>29936443.0</td>
      <td>110029.0</td>
      <td>0.028674</td>
      <td>0.008737</td>
      <td>0.005376</td>
      <td>0.014262</td>
      <td>0.670157</td>
      <td>0.204188</td>
      <td>0.125654</td>
    </tr>
    <tr>
      <th>895</th>
      <td>City</td>
      <td>Smithfield</td>
      <td>Virginia</td>
      <td>Virginia Beach, VA</td>
      <td>2251.0</td>
      <td>2251.0</td>
      <td>2252.0</td>
      <td>6754.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>...</td>
      <td>68564829.0</td>
      <td>76200890.0</td>
      <td>379356.5</td>
      <td>0.008885</td>
      <td>0.008885</td>
      <td>0.065719</td>
      <td>0.027835</td>
      <td>0.106383</td>
      <td>0.106383</td>
      <td>0.787234</td>
    </tr>
    <tr>
      <th>894</th>
      <td>City</td>
      <td>Secaucus</td>
      <td>New Jersey</td>
      <td>New York, NY</td>
      <td>1586.0</td>
      <td>1584.0</td>
      <td>1586.0</td>
      <td>4756.0</td>
      <td>1106.0</td>
      <td>537.0</td>
      <td>...</td>
      <td>277046340.0</td>
      <td>864994299.0</td>
      <td>391859.0</td>
      <td>0.697352</td>
      <td>0.339015</td>
      <td>0.288777</td>
      <td>0.441758</td>
      <td>0.526416</td>
      <td>0.255593</td>
      <td>0.217991</td>
    </tr>
    <tr>
      <th>893</th>
      <td>City</td>
      <td>Seaside Park</td>
      <td>New Jersey</td>
      <td>New York, NY</td>
      <td>672.0</td>
      <td>672.0</td>
      <td>672.0</td>
      <td>2016.0</td>
      <td>443.0</td>
      <td>538.0</td>
      <td>...</td>
      <td>359297149.0</td>
      <td>827539382.0</td>
      <td>558632.0</td>
      <td>0.659226</td>
      <td>0.800595</td>
      <td>0.595238</td>
      <td>0.685020</td>
      <td>0.320782</td>
      <td>0.389573</td>
      <td>0.289645</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1775</th>
      <td>Zip</td>
      <td>22307</td>
      <td>Virginia</td>
      <td>NaN</td>
      <td>1483.0</td>
      <td>1097.0</td>
      <td>1970.0</td>
      <td>4550.0</td>
      <td>181.0</td>
      <td>215.0</td>
      <td>...</td>
      <td>45692041.0</td>
      <td>153788304.0</td>
      <td>248578.0</td>
      <td>0.122050</td>
      <td>0.195989</td>
      <td>0.031472</td>
      <td>0.100659</td>
      <td>0.395197</td>
      <td>0.469432</td>
      <td>0.135371</td>
    </tr>
    <tr>
      <th>1774</th>
      <td>Zip</td>
      <td>21921</td>
      <td>Maryland</td>
      <td>NaN</td>
      <td>5270.0</td>
      <td>5284.0</td>
      <td>5403.0</td>
      <td>15957.0</td>
      <td>12.0</td>
      <td>47.0</td>
      <td>...</td>
      <td>41149066.0</td>
      <td>53223597.0</td>
      <td>316059.0</td>
      <td>0.002277</td>
      <td>0.008895</td>
      <td>0.017583</td>
      <td>0.009651</td>
      <td>0.077922</td>
      <td>0.305195</td>
      <td>0.616883</td>
    </tr>
    <tr>
      <th>1773</th>
      <td>Zip</td>
      <td>21903</td>
      <td>Maryland</td>
      <td>NaN</td>
      <td>784.0</td>
      <td>851.0</td>
      <td>856.0</td>
      <td>2491.0</td>
      <td>10.0</td>
      <td>37.0</td>
      <td>...</td>
      <td>21432532.0</td>
      <td>30859486.0</td>
      <td>260047.5</td>
      <td>0.012755</td>
      <td>0.043478</td>
      <td>0.064252</td>
      <td>0.040947</td>
      <td>0.098039</td>
      <td>0.362745</td>
      <td>0.539216</td>
    </tr>
    <tr>
      <th>1780</th>
      <td>Zip</td>
      <td>22578</td>
      <td>Virginia</td>
      <td>NaN</td>
      <td>458.0</td>
      <td>448.0</td>
      <td>462.0</td>
      <td>1368.0</td>
      <td>73.0</td>
      <td>159.0</td>
      <td>...</td>
      <td>118131703.0</td>
      <td>184974026.0</td>
      <td>452094.0</td>
      <td>0.159389</td>
      <td>0.354911</td>
      <td>0.370130</td>
      <td>0.294591</td>
      <td>0.181141</td>
      <td>0.394541</td>
      <td>0.424318</td>
    </tr>
    <tr>
      <th>2609</th>
      <td>Zip</td>
      <td>33578</td>
      <td>Florida</td>
      <td>NaN</td>
      <td>5975.0</td>
      <td>4537.0</td>
      <td>3232.0</td>
      <td>13744.0</td>
      <td>8.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>56852018.0</td>
      <td>59115506.0</td>
      <td>363355.0</td>
      <td>0.001339</td>
      <td>0.001322</td>
      <td>0.038366</td>
      <td>0.010041</td>
      <td>0.057971</td>
      <td>0.043478</td>
      <td>0.898551</td>
    </tr>
  </tbody>
</table>
<p>2610 rows × 24 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uw</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;RegionType&#39;</span><span class="p">,</span> <span class="s1">&#39;RegionName&#39;</span><span class="p">,</span> <span class="s1">&#39;AllHomes_Tier1&#39;</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RegionType</th>
      <th>RegionName</th>
      <th>StateName</th>
      <th>MSAName</th>
      <th>AllHomes_Tier1</th>
      <th>AllHomes_Tier2</th>
      <th>AllHomes_Tier3</th>
      <th>AllHomes_AllTiers</th>
      <th>UWHomes_Tier1</th>
      <th>UWHomes_Tier2</th>
      <th>...</th>
      <th>UWHomes_TotalValue_Tier3</th>
      <th>UWHomes_TotalValue_AllTiers</th>
      <th>UWHomes_MedianValue_AllTiers</th>
      <th>AllHomes_Tier1_ShareUW</th>
      <th>AllHomes_Tier2_ShareUW</th>
      <th>AllHomes_Tier3_ShareUW</th>
      <th>AllHomes_AllTiers_ShareUW</th>
      <th>UWHomes_ShareInTier1</th>
      <th>UWHomes_ShareInTier2</th>
      <th>UWHomes_ShareInTier3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>690</th>
      <td>City</td>
      <td>Abbeville</td>
      <td>Louisiana</td>
      <td>Lafayette, LA</td>
      <td>1995.0</td>
      <td>1995.0</td>
      <td>1997.0</td>
      <td>5987.0</td>
      <td>196.0</td>
      <td>512.0</td>
      <td>...</td>
      <td>30967445.0</td>
      <td>100185101.0</td>
      <td>103417.0</td>
      <td>0.098246</td>
      <td>0.256642</td>
      <td>0.095643</td>
      <td>0.150159</td>
      <td>0.218020</td>
      <td>0.569522</td>
      <td>0.212458</td>
    </tr>
    <tr>
      <th>811</th>
      <td>City</td>
      <td>Aberdeen</td>
      <td>Washington</td>
      <td>Aberdeen, WA</td>
      <td>2799.0</td>
      <td>2799.0</td>
      <td>2799.0</td>
      <td>8397.0</td>
      <td>2412.0</td>
      <td>1145.0</td>
      <td>...</td>
      <td>64053930.0</td>
      <td>389836601.0</td>
      <td>87694.0</td>
      <td>0.861736</td>
      <td>0.409075</td>
      <td>0.091104</td>
      <td>0.453972</td>
      <td>0.632739</td>
      <td>0.300367</td>
      <td>0.066894</td>
    </tr>
    <tr>
      <th>346</th>
      <td>City</td>
      <td>Absecon</td>
      <td>New Jersey</td>
      <td>Egg Harbor Township, NJ</td>
      <td>1097.0</td>
      <td>1097.0</td>
      <td>1097.0</td>
      <td>3291.0</td>
      <td>40.0</td>
      <td>55.0</td>
      <td>...</td>
      <td>18714933.0</td>
      <td>33321640.0</td>
      <td>180979.0</td>
      <td>0.036463</td>
      <td>0.050137</td>
      <td>0.060164</td>
      <td>0.048921</td>
      <td>0.248447</td>
      <td>0.341615</td>
      <td>0.409938</td>
    </tr>
    <tr>
      <th>939</th>
      <td>City</td>
      <td>Aiea</td>
      <td>Hawaii</td>
      <td>Honolulu, HI</td>
      <td>4209.0</td>
      <td>4209.0</td>
      <td>4211.0</td>
      <td>12629.0</td>
      <td>0.0</td>
      <td>146.0</td>
      <td>...</td>
      <td>35306798.0</td>
      <td>137032636.0</td>
      <td>708881.0</td>
      <td>0.000000</td>
      <td>0.034688</td>
      <td>0.007837</td>
      <td>0.014174</td>
      <td>0.000000</td>
      <td>0.815642</td>
      <td>0.184358</td>
    </tr>
    <tr>
      <th>1151</th>
      <td>City</td>
      <td>Alva</td>
      <td>Florida</td>
      <td>Fort Myers, FL</td>
      <td>589.0</td>
      <td>589.0</td>
      <td>590.0</td>
      <td>1768.0</td>
      <td>6.0</td>
      <td>38.0</td>
      <td>...</td>
      <td>59575578.0</td>
      <td>69446593.0</td>
      <td>369560.0</td>
      <td>0.010187</td>
      <td>0.064516</td>
      <td>0.164407</td>
      <td>0.079751</td>
      <td>0.042553</td>
      <td>0.269504</td>
      <td>0.687943</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2603</th>
      <td>Zip</td>
      <td>98584</td>
      <td>Washington</td>
      <td>NaN</td>
      <td>4708.0</td>
      <td>4694.0</td>
      <td>4766.0</td>
      <td>14168.0</td>
      <td>8.0</td>
      <td>41.0</td>
      <td>...</td>
      <td>98174201.0</td>
      <td>108265864.0</td>
      <td>366002.0</td>
      <td>0.001699</td>
      <td>0.008735</td>
      <td>0.047839</td>
      <td>0.019551</td>
      <td>0.028881</td>
      <td>0.148014</td>
      <td>0.823105</td>
    </tr>
    <tr>
      <th>2604</th>
      <td>Zip</td>
      <td>98588</td>
      <td>Washington</td>
      <td>NaN</td>
      <td>469.0</td>
      <td>479.0</td>
      <td>479.0</td>
      <td>1427.0</td>
      <td>17.0</td>
      <td>35.0</td>
      <td>...</td>
      <td>51494123.0</td>
      <td>60982770.0</td>
      <td>351648.0</td>
      <td>0.036247</td>
      <td>0.073069</td>
      <td>0.229645</td>
      <td>0.113525</td>
      <td>0.104938</td>
      <td>0.216049</td>
      <td>0.679012</td>
    </tr>
    <tr>
      <th>2605</th>
      <td>Zip</td>
      <td>98592</td>
      <td>Washington</td>
      <td>NaN</td>
      <td>464.0</td>
      <td>470.0</td>
      <td>493.0</td>
      <td>1427.0</td>
      <td>8.0</td>
      <td>29.0</td>
      <td>...</td>
      <td>73407109.0</td>
      <td>82715412.0</td>
      <td>436490.5</td>
      <td>0.017241</td>
      <td>0.061702</td>
      <td>0.273834</td>
      <td>0.120533</td>
      <td>0.046512</td>
      <td>0.168605</td>
      <td>0.784884</td>
    </tr>
    <tr>
      <th>2606</th>
      <td>Zip</td>
      <td>98595</td>
      <td>Washington</td>
      <td>NaN</td>
      <td>558.0</td>
      <td>571.0</td>
      <td>598.0</td>
      <td>1727.0</td>
      <td>119.0</td>
      <td>104.0</td>
      <td>...</td>
      <td>13761194.0</td>
      <td>40365702.0</td>
      <td>131441.0</td>
      <td>0.213262</td>
      <td>0.182137</td>
      <td>0.095318</td>
      <td>0.162131</td>
      <td>0.425000</td>
      <td>0.371429</td>
      <td>0.203571</td>
    </tr>
    <tr>
      <th>2607</th>
      <td>Zip</td>
      <td>98612</td>
      <td>Washington</td>
      <td>NaN</td>
      <td>365.0</td>
      <td>376.0</td>
      <td>409.0</td>
      <td>1150.0</td>
      <td>91.0</td>
      <td>79.0</td>
      <td>...</td>
      <td>14406737.0</td>
      <td>50284001.0</td>
      <td>230495.0</td>
      <td>0.249315</td>
      <td>0.210106</td>
      <td>0.092910</td>
      <td>0.180870</td>
      <td>0.437500</td>
      <td>0.379808</td>
      <td>0.182692</td>
    </tr>
  </tbody>
</table>
<p>2610 rows × 24 columns</p>
</div></div></div>
</div>
</section>
<section id="renaming-columns">
<h2><span class="section-number">4.3.5. </span>Renaming columns<a class="headerlink" href="#renaming-columns" title="Permalink to this headline">#</a></h2>
<p>While cleaning our data, we might want to rename our columns, or variables. You can do this automatically with something like <code class="docutils literal notranslate"><span class="pre">pyjanitor</span></code> (see below). You can also do it when importing the data using <code class="docutils literal notranslate"><span class="pre">.read_csv</span></code> from <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, if you know that you’ll want to change the name.</p>
<p>It is also easy enough to do using <code class="docutils literal notranslate"><span class="pre">.rename</span></code> from <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. You give it a mapping of old name to new name. I’ll rename <em>MSAName</em> for fun.</p>
<p>Note the <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> argument. You’ll see this a lot for <code class="docutils literal notranslate"><span class="pre">pandas</span></code> methods. This makes it so that we don’t have to do a <code class="docutils literal notranslate"><span class="pre">uw</span> <span class="pre">=</span> <span class="pre">uw.rename()</span></code>. Instead, we save over the old DataFrame with the new one with the new column name.</p>
<p>You can read more <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.rename.html">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uw</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;MSAName&#39;</span><span class="p">:</span><span class="s1">&#39;msaname&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="dropping-columns">
<h2><span class="section-number">4.3.6. </span>Dropping columns<a class="headerlink" href="#dropping-columns" title="Permalink to this headline">#</a></h2>
<p>We can also simply drop a column of data. You could do this via data subsets (e.g. <code class="docutils literal notranslate"><span class="pre">.iloc</span></code>), but this method lets you use <code class="docutils literal notranslate"><span class="pre">.drop()</span></code> to specify the name of the column. It’s a little clearer doing things this way.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> option means that you are dropping the column named. I’ve picked a column at random to drop. Notice that I’m saving my work back to the <em>uw</em> DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uw</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;UWHomes_TotalValue_Tier3&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="missing-data-example">
<h2><span class="section-number">4.3.7. </span>Missing data example<a class="headerlink" href="#missing-data-example" title="Permalink to this headline">#</a></h2>
<p>Finally, let’s try some more complicated code. I found this example <a class="reference external" href="https://towardsdatascience.com/a-better-eda-with-pandas-profiling-e842a00e1136">here</a>.</p>
<p>First, we will create a DataFrame that has the total number of missing values for each variable. We can sort the data using <code class="docutils literal notranslate"><span class="pre">sort_values()</span></code>. The <code class="docutils literal notranslate"><span class="pre">ascending=False</span></code> option will have the variable with the largest number of missings at the top.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>By the way, you’ll also see a <code class="docutils literal notranslate"><span class="pre">isnull()</span></code> method that does the same thing as <code class="docutils literal notranslate"><span class="pre">isna()</span></code>.</p>
<p>Next, let’s create a DataFrame that that has the percentage of values that are missing for each variable. This is neat one - we are creating a DataFrame of values (total number missing) for the numerator and another DataFrame of values (total number) for the denominator. Then, we are dividing two DataFrames, giving us another DataFrame of the resulting division. We then sort.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">percent</span> <span class="o">=</span> <span class="p">(</span><span class="n">uw</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">uw</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can use a new function called <code class="docutils literal notranslate"><span class="pre">concat</span></code> from <code class="docutils literal notranslate"><span class="pre">pandas</span></code> that combines data, either as rows (stacking) or columns (combining). We’ll combine columns, with means concatenating along axis=1. We’ll name both columns. We can do this because each DataFrame has the same index created by <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, all of our variable names. So, there’s a one-to-one correspondence between the two DataFrames.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">total</span><span class="p">,</span> <span class="n">percent</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">,</span> <span class="s1">&#39;Missing Percent&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s take the percents and multiply all of them by 100, just to make them look like percents. And to show you, again, that you can.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_data</span><span class="p">[</span><span class="s1">&#39;Missing Percent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_data</span><span class="p">[</span><span class="s1">&#39;Missing Percent&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<p>For the last step, we can filter and just get the variable names where more than 10% of our data are missing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_data</span><span class="p">[</span><span class="n">missing_data</span><span class="p">[</span><span class="s1">&#39;Missing Percent&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total</th>
      <th>Missing Percent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>msaname</th>
      <td>1539</td>
      <td>58.965517</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="back-to-stocks">
<h2><span class="section-number">4.3.8. </span>Back to stocks<a class="headerlink" href="#back-to-stocks" title="Permalink to this headline">#</a></h2>
<p>We can bring back the stock data too, as that data has some missing values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prices</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://github.com/aaiken1/fin-data-analysis-python/raw/main/data/tr_eikon_eod_data.csv&#39;</span><span class="p">,</span>
                      <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Why are there missing values? Holidays and weekends, when trading doesn’t take place.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prices</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AAPL.O    78
MSFT.O    78
INTC.O    78
AMZN.O    78
GS.N      78
SPY       78
.SPX      78
.VIX      78
EUR=       0
XAU=       5
GDX       78
GLD       78
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We can drop these rows. We’ll specify <code class="docutils literal notranslate"><span class="pre">axis=0</span></code>, or rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prices</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">prices</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AAPL.O    0
MSFT.O    0
INTC.O    0
AMZN.O    0
GS.N      0
SPY       0
.SPX      0
.VIX      0
EUR=      0
XAU=      0
GDX       0
GLD       0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prices</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AAPL.O</th>
      <th>MSFT.O</th>
      <th>INTC.O</th>
      <th>AMZN.O</th>
      <th>GS.N</th>
      <th>SPY</th>
      <th>.SPX</th>
      <th>.VIX</th>
      <th>EUR=</th>
      <th>XAU=</th>
      <th>GDX</th>
      <th>GLD</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-04</th>
      <td>30.572827</td>
      <td>30.950</td>
      <td>20.880</td>
      <td>133.900</td>
      <td>173.08</td>
      <td>113.33</td>
      <td>1132.99</td>
      <td>20.04</td>
      <td>1.4411</td>
      <td>1120.00</td>
      <td>47.71</td>
      <td>109.80</td>
    </tr>
    <tr>
      <th>2010-01-05</th>
      <td>30.625684</td>
      <td>30.960</td>
      <td>20.870</td>
      <td>134.690</td>
      <td>176.14</td>
      <td>113.63</td>
      <td>1136.52</td>
      <td>19.35</td>
      <td>1.4368</td>
      <td>1118.65</td>
      <td>48.17</td>
      <td>109.70</td>
    </tr>
    <tr>
      <th>2010-01-06</th>
      <td>30.138541</td>
      <td>30.770</td>
      <td>20.800</td>
      <td>132.250</td>
      <td>174.26</td>
      <td>113.71</td>
      <td>1137.14</td>
      <td>19.16</td>
      <td>1.4412</td>
      <td>1138.50</td>
      <td>49.34</td>
      <td>111.51</td>
    </tr>
    <tr>
      <th>2010-01-07</th>
      <td>30.082827</td>
      <td>30.452</td>
      <td>20.600</td>
      <td>130.000</td>
      <td>177.67</td>
      <td>114.19</td>
      <td>1141.69</td>
      <td>19.06</td>
      <td>1.4318</td>
      <td>1131.90</td>
      <td>49.10</td>
      <td>110.82</td>
    </tr>
    <tr>
      <th>2010-01-08</th>
      <td>30.282827</td>
      <td>30.660</td>
      <td>20.830</td>
      <td>133.520</td>
      <td>174.31</td>
      <td>114.57</td>
      <td>1144.98</td>
      <td>18.13</td>
      <td>1.4412</td>
      <td>1136.10</td>
      <td>49.84</td>
      <td>111.37</td>
    </tr>
    <tr>
      <th>2010-01-11</th>
      <td>30.015684</td>
      <td>30.270</td>
      <td>20.950</td>
      <td>130.308</td>
      <td>171.56</td>
      <td>114.73</td>
      <td>1146.98</td>
      <td>17.55</td>
      <td>1.4513</td>
      <td>1152.60</td>
      <td>50.17</td>
      <td>112.85</td>
    </tr>
    <tr>
      <th>2010-01-12</th>
      <td>29.674256</td>
      <td>30.070</td>
      <td>20.608</td>
      <td>127.350</td>
      <td>167.82</td>
      <td>113.66</td>
      <td>1136.22</td>
      <td>18.25</td>
      <td>1.4494</td>
      <td>1127.30</td>
      <td>48.35</td>
      <td>110.49</td>
    </tr>
    <tr>
      <th>2010-01-13</th>
      <td>30.092827</td>
      <td>30.350</td>
      <td>20.960</td>
      <td>129.110</td>
      <td>169.07</td>
      <td>114.62</td>
      <td>1145.68</td>
      <td>17.85</td>
      <td>1.4510</td>
      <td>1138.40</td>
      <td>48.86</td>
      <td>111.54</td>
    </tr>
    <tr>
      <th>2010-01-14</th>
      <td>29.918542</td>
      <td>30.960</td>
      <td>21.480</td>
      <td>127.350</td>
      <td>168.53</td>
      <td>114.93</td>
      <td>1148.46</td>
      <td>17.63</td>
      <td>1.4502</td>
      <td>1142.85</td>
      <td>48.60</td>
      <td>112.03</td>
    </tr>
    <tr>
      <th>2010-01-15</th>
      <td>29.418542</td>
      <td>30.860</td>
      <td>20.800</td>
      <td>127.140</td>
      <td>165.21</td>
      <td>113.64</td>
      <td>1136.03</td>
      <td>17.91</td>
      <td>1.4382</td>
      <td>1129.90</td>
      <td>47.42</td>
      <td>110.86</td>
    </tr>
    <tr>
      <th>2010-01-19</th>
      <td>30.719969</td>
      <td>31.100</td>
      <td>21.050</td>
      <td>127.610</td>
      <td>166.86</td>
      <td>115.06</td>
      <td>1150.23</td>
      <td>17.58</td>
      <td>1.4298</td>
      <td>1137.70</td>
      <td>47.69</td>
      <td>111.52</td>
    </tr>
    <tr>
      <th>2010-01-20</th>
      <td>30.246398</td>
      <td>30.585</td>
      <td>21.080</td>
      <td>125.780</td>
      <td>167.79</td>
      <td>113.89</td>
      <td>1138.04</td>
      <td>18.68</td>
      <td>1.4101</td>
      <td>1111.30</td>
      <td>45.73</td>
      <td>108.94</td>
    </tr>
    <tr>
      <th>2010-01-21</th>
      <td>29.724542</td>
      <td>30.010</td>
      <td>20.840</td>
      <td>126.620</td>
      <td>160.87</td>
      <td>111.70</td>
      <td>1116.48</td>
      <td>22.27</td>
      <td>1.4090</td>
      <td>1094.75</td>
      <td>43.75</td>
      <td>107.37</td>
    </tr>
    <tr>
      <th>2010-01-22</th>
      <td>28.249972</td>
      <td>28.960</td>
      <td>19.910</td>
      <td>121.430</td>
      <td>154.12</td>
      <td>109.21</td>
      <td>1091.76</td>
      <td>27.31</td>
      <td>1.4137</td>
      <td>1092.60</td>
      <td>43.79</td>
      <td>107.17</td>
    </tr>
    <tr>
      <th>2010-01-25</th>
      <td>29.010685</td>
      <td>29.320</td>
      <td>20.320</td>
      <td>120.310</td>
      <td>154.98</td>
      <td>109.77</td>
      <td>1096.78</td>
      <td>25.41</td>
      <td>1.4150</td>
      <td>1097.85</td>
      <td>43.19</td>
      <td>107.48</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pyjanitor">
<h2><span class="section-number">4.3.9. </span>Pyjanitor<a class="headerlink" href="#pyjanitor" title="Permalink to this headline">#</a></h2>
<p>We are going to look at a fun package that is based on something from the <a class="reference external" href="https://www.r-project.org">R</a> statistical programming language, called <a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/#installation">pyjanitor</a>.</p>
<p>To use this package, you’ll need to type the following in the terminal (Mac) or cmd terminal (Windows).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pyjanitor</span>
</pre></div>
</div>
<p>This will install <code class="docutils literal notranslate"><span class="pre">pyjanitor</span></code> using <code class="docutils literal notranslate"><span class="pre">pip</span></code>. Again, <strong>if you’re using Windows, make sure that your terminal is cmd and not Powershell</strong>. <code class="docutils literal notranslate"><span class="pre">pip</span></code> works in Powershell, but you have to change a system setting first.You’ll need to restart VS Code once you’ve installed it.</p>
<p>If you’re using Google Colab, there’s currently a bug in pyjanitor that requires you to install a previous version. You can do this in a Jupyter cell. Note that you need to use <code class="docutils literal notranslate"><span class="pre">!pip</span></code> when using a terminal command inside of a Jupyter notebook.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!pip install pyjanitor==0.23.1
</pre></div>
</div>
<p>There are even <a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/api/finance/">finance specific tools</a>.</p>
<p>We can bring in <code class="docutils literal notranslate"><span class="pre">janitor</span></code> and treat it as part of <code class="docutils literal notranslate"><span class="pre">pandas</span></code> using the <code class="docutils literal notranslate"><span class="pre">import</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">janitor</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pyjanitor</span></code> lets us have an interesting workflow. We can read in our data set, remove columns, drop missings, and rename columns, all in one series of steps.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prices</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://github.com/aaiken1/fin-data-analysis-python/raw/main/data/tr_eikon_eod_data.csv&#39;</span><span class="p">,</span>
                      <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="o">.</span><span class="n">remove_columns</span><span class="p">([</span><span class="s1">&#39;GLD&#39;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;AAPL.O&#39;</span><span class="p">,</span> <span class="s1">&#39;AAPL&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;MSFT.O&#39;</span><span class="p">,</span> <span class="s1">&#39;MSFT&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>There are also some built-in, general functions. <code class="docutils literal notranslate"><span class="pre">clean_names()</span></code> does what it says. For example, it sets all characters in a variable name to lower case.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prices</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://github.com/aaiken1/fin-data-analysis-python/raw/main/data/tr_eikon_eod_data.csv&#39;</span><span class="p">,</span>
                      <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">prices</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">clean_names</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Note the syntax - you start with the DataFrame and then apply the function to it.</p>
<p>You might see another syntax, though. You can import the functions directly and then include the DataFrame as an argument to that function. Both ways are detailed in the <a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/#installation">pyjanitor</a> instructions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">janitor</span> <span class="kn">import</span> <span class="n">clean_names</span><span class="p">,</span> <span class="n">remove_empty</span>
 
<span class="n">prices</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://github.com/aaiken1/fin-data-analysis-python/raw/main/data/tr_eikon_eod_data.csv&#39;</span><span class="p">,</span>
                      <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">prices</span> <span class="o">=</span> <span class="n">clean_names</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span> <span class="c1"># See the difference?</span>
</pre></div>
</div>
</div>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">flag_nulls</span></code> creates a new variable that will have a 1 if any of the variables specified are missing. In this case, I didn’t specify anything, so it will look across all of the variables. If any variable is <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, then that row gets a 1. Notice the <strong>any</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prices</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://github.com/aaiken1/fin-data-analysis-python/raw/main/data/tr_eikon_eod_data.csv&#39;</span><span class="p">,</span>
                      <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">prices</span><span class="o">.</span><span class="n">flag_nulls</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AAPL.O</th>
      <th>MSFT.O</th>
      <th>INTC.O</th>
      <th>AMZN.O</th>
      <th>GS.N</th>
      <th>SPY</th>
      <th>.SPX</th>
      <th>.VIX</th>
      <th>EUR=</th>
      <th>XAU=</th>
      <th>GDX</th>
      <th>GLD</th>
      <th>null_flag</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-01</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.4323</td>
      <td>1096.35</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2010-01-04</th>
      <td>30.572827</td>
      <td>30.950</td>
      <td>20.88</td>
      <td>133.90</td>
      <td>173.08</td>
      <td>113.33</td>
      <td>1132.99</td>
      <td>20.04</td>
      <td>1.4411</td>
      <td>1120.00</td>
      <td>47.71</td>
      <td>109.80</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2010-01-05</th>
      <td>30.625684</td>
      <td>30.960</td>
      <td>20.87</td>
      <td>134.69</td>
      <td>176.14</td>
      <td>113.63</td>
      <td>1136.52</td>
      <td>19.35</td>
      <td>1.4368</td>
      <td>1118.65</td>
      <td>48.17</td>
      <td>109.70</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2010-01-06</th>
      <td>30.138541</td>
      <td>30.770</td>
      <td>20.80</td>
      <td>132.25</td>
      <td>174.26</td>
      <td>113.71</td>
      <td>1137.14</td>
      <td>19.16</td>
      <td>1.4412</td>
      <td>1138.50</td>
      <td>49.34</td>
      <td>111.51</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2010-01-07</th>
      <td>30.082827</td>
      <td>30.452</td>
      <td>20.60</td>
      <td>130.00</td>
      <td>177.67</td>
      <td>114.19</td>
      <td>1141.69</td>
      <td>19.06</td>
      <td>1.4318</td>
      <td>1131.90</td>
      <td>49.10</td>
      <td>110.82</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2018-06-25</th>
      <td>182.170000</td>
      <td>98.390</td>
      <td>50.71</td>
      <td>1663.15</td>
      <td>221.54</td>
      <td>271.00</td>
      <td>2717.07</td>
      <td>17.33</td>
      <td>1.1702</td>
      <td>1265.00</td>
      <td>22.01</td>
      <td>119.89</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2018-06-26</th>
      <td>184.430000</td>
      <td>99.080</td>
      <td>49.67</td>
      <td>1691.09</td>
      <td>221.58</td>
      <td>271.60</td>
      <td>2723.06</td>
      <td>15.92</td>
      <td>1.1645</td>
      <td>1258.64</td>
      <td>21.95</td>
      <td>119.26</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2018-06-27</th>
      <td>184.160000</td>
      <td>97.540</td>
      <td>48.76</td>
      <td>1660.51</td>
      <td>220.18</td>
      <td>269.35</td>
      <td>2699.63</td>
      <td>17.91</td>
      <td>1.1552</td>
      <td>1251.62</td>
      <td>21.81</td>
      <td>118.58</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2018-06-28</th>
      <td>185.500000</td>
      <td>98.630</td>
      <td>49.25</td>
      <td>1701.45</td>
      <td>223.42</td>
      <td>270.89</td>
      <td>2716.31</td>
      <td>16.85</td>
      <td>1.1567</td>
      <td>1247.88</td>
      <td>21.93</td>
      <td>118.22</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2018-06-29</th>
      <td>185.110000</td>
      <td>98.610</td>
      <td>49.71</td>
      <td>1699.80</td>
      <td>220.57</td>
      <td>271.28</td>
      <td>2718.37</td>
      <td>16.09</td>
      <td>1.1683</td>
      <td>1252.25</td>
      <td>22.31</td>
      <td>118.65</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2216 rows × 13 columns</p>
</div></div></div>
</div>
<p>Finally, simple way to see if we have any rows of duplicate data. This will happen surprisingly (and unfortunately) often when we start merging data together.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prices</span><span class="o">.</span><span class="n">get_dupes</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AAPL.O</th>
      <th>MSFT.O</th>
      <th>INTC.O</th>
      <th>AMZN.O</th>
      <th>GS.N</th>
      <th>SPY</th>
      <th>.SPX</th>
      <th>.VIX</th>
      <th>EUR=</th>
      <th>XAU=</th>
      <th>GDX</th>
      <th>GLD</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="4_1_pandas.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">4.2. </span>pandas</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="4_3_eda.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4.4. </span>Exploratory data analysis (EDA)</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Prof. Adam Aiken<br/>
  
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>