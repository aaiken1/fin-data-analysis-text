
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>13. Monte Carlo and portfolios &#8212; Data Analysis in Finance</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="14. Option basics" href="14_options.html" />
    <link rel="prev" title="12. Risk management" href="12_risk_mang.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/cat.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Data Analysis in Finance</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1_finpyth.html">
   1. Why Python and finance?
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="2_intro.html">
   2. Python set-up
   <a id="python_set-up">
   </a>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="2_0_install.html">
     2.2. Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_1_jupyter.html">
     2.3. Jupyter notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_2_vscode.html">
     2.4. VS Code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_3_markdown.html">
     2.5. Markdown
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_4_packages.html">
     2.6. Packages
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The Basics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="3_intro.html">
   3. CompSci 101: Types, control, and numpy arrays
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="3_0_comp101.html">
     3.1. The Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="3_1_numpy.html">
     3.2. Numpy and arrays
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="4_intro.html">
   4. Pandas and data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="4_0_dataframes.html">
     4.2. Data importing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_1_pandas.html">
     4.3. pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_2_cleaning_data.html">
     4.4. Cleaning our data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_3_eda.html">
     4.5. Exploratory data analysis (EDA)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_4_merge_shape.html">
     4.6. Merging and reshaping data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="5_intro.html">
   5. Data visualization
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="5_0_matplotlib.html">
     5.2. matplotlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="5_1_plotly.html">
     5.3. plotly
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="5_2_seaborn.html">
     5.4. seaborn
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6_financial_ts.html">
   6. Financial time series
   <a id="financial-time-series">
   </a>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Applications
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="7_nasdaq_api.html">
   7. Using NASDAQ BTC data
   <a id="btc-sim">
   </a>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="8_port_math.html">
   8. Essential portfolio math
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="9_portfolio_opt.html">
   9. Portfolio optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10_factor_models.html">
   10. Factor models
   <a id="factor_models">
   </a>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11_regression_topics.html">
   11. Regression topics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12_risk_mang.html">
   12. Risk management
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   13. Monte Carlo and portfolios
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14_options.html">
   14. Option basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="15_logit_credit.html">
   15. Logit models
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Labs
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="lab_intro.html">
   Our labs
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Exams
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="exam_intro.html">
   Our Exams
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/chapters/13_monte_carlo.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/chapters/13_monte_carlo.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-12-highlights">
   13.1. Chapter 12 Highlights
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-correlation-affects-our-simulations">
   13.2. How correlation affects our simulations
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Monte Carlo and portfolios</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-12-highlights">
   13.1. Chapter 12 Highlights
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-correlation-affects-our-simulations">
   13.2. How correlation affects our simulations
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="monte-carlo-and-portfolios">
<h1><span class="section-number">13. </span>Monte Carlo and portfolios<a class="headerlink" href="#monte-carlo-and-portfolios" title="Permalink to this headline">¶</a></h1>
<p>We saw how to simulate the price of an asset back when we looked at the price of <a class="reference external" href="7_nasdaq_api.html#btc-sim">Bitcoin</a> and using the Nasdaq API. We are going to take a more complete look here at <strong>simulating correlated assets within a portfolio</strong>. These methods can be used for measuring portfolio risk, for simulating client portfolios in a <a class="reference external" href="https://www.kitces.com/blog/volatility-drag-variance-drain-mean-arithmetic-vs-geometric-average-investment-returns/">financial planning setting</a>, or <a class="reference external" href="https://en.wikipedia.org/wiki/Monte_Carlo_methods_for_option_pricing">pricing complex options</a> like <a class="reference external" href="https://en.wikipedia.org/wiki/Asian_option">Asian options</a>.</p>
<p>I am basing a lot of my code and discussion on this <a class="reference external" href="https://medium.com/codex/simulate-multi-asset-baskets-with-correlated-price-paths-using-python-472cbec4e379">blog post</a>.</p>
<p>This material is related to the <a class="reference external" href="https://www.codearmo.com/python-tutorial/heston-model-simulation-python">Heston model</a> for simulating the prices of correlated assets. The volatility of the assets are linked together. In the Heston model, the volatility of an asset today is also related to past volatility. We’ll do more on this when we get to <a class="reference external" href="https://en.wikipedia.org/wiki/Autoregressive_conditional_heteroskedasticity">GARCH models</a>.</p>
<p>We’ll also use <strong>pandas data-reader</strong> to bring in some stock prices from Yahoo! finance. You’ll need to run <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pandas-datareader</span></code> in the terminal. You can read more about it <a class="reference external" href="https://pydata.github.io/pandas-datareader/remote_data.html">here</a>.</p>
<p>The textbook goes into more detail than we need, but this is the type of material that you’d cover in a first-semester mathematical finance course in a Masters program.</p>
<div class="section" id="chapter-12-highlights">
<h2><span class="section-number">13.1. </span>Chapter 12 Highlights<a class="headerlink" href="#chapter-12-highlights" title="Permalink to this headline">¶</a></h2>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Topic</p></th>
<th class="text-align:left head"><p>Pages</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><strong>Basic Price Simulation</strong>. Simulations with just a single asset. Our author uses these techniques for basic option pricing later on.</p></td>
<td class="text-align:left"><p>352 - 365</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><strong>Stochastic Volatility</strong>. Heston volatility model and Cholesky decomposition for correlated assets.</p></td>
<td class="text-align:left"><p>365 - 368</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="how-correlation-affects-our-simulations">
<h2><span class="section-number">13.2. </span>How correlation affects our simulations<a class="headerlink" href="#how-correlation-affects-our-simulations" title="Permalink to this headline">¶</a></h2>
<p>However, when we start to form portfolios, we are going to care about the correlations across assets. We’ve already seen this when looking at portfolio math. When simulating the Bitcoin prices, we took random numbers from the standard normal distribution and then scaled them by our estimate for the volatility of BTC. This allowed us to capture the randomness of the returns.</p>
<p>However, when dealing with more than one asset, we can’t do that, since the assets are <strong>not independent</strong> from one another. If Apple goes up, Google is more likely to have gone up as well. The two stocks are <strong>correlated</strong>. How can we account for this in our simulation? We will create <strong>correlated random shocks</strong> (<span class="math notranslate nohighlight">\(W\)</span>), where the random movement of one asset depends on another assets movement.</p>
<p>Let’s try a simulation to see what’s going on. I’ll draw two random variables from the standard normal distribution, N(0,1). The random part of the return for Asset 1, <span class="math notranslate nohighlight">\(W_1\)</span>, is simply the random draw, <span class="math notranslate nohighlight">\(x_1\)</span>. However, the random part of the return for Asset 2, <span class="math notranslate nohighlight">\(W_2\)</span>, is correlated with whatever <span class="math notranslate nohighlight">\(x_1\)</span> ends up being. Mathematically, this dependent random movement is given as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-1c96f169-25b1-4741-a5f3-1742ccf08ff1">
<span class="eqno">(13.1)<a class="headerlink" href="#equation-1c96f169-25b1-4741-a5f3-1742ccf08ff1" title="Permalink to this equation">¶</a></span>\[\begin{align}
W_2 = \rho x_1 + (1 - \sqrt{\rho^2}) x_2
\end{align}\]</div>
<p>I’ll set the correlation, <span class="math notranslate nohighlight">\(\rho\)</span>, to be -0.80. These two assets are negatively correlated, so they should move in opposite directions. We’ll set each asset to have the same mean return and same volatility. I’ll set the starting price of each of these assets to 1.</p>
<p>We’ll bring in our usual packages and try this out. This code should look a lot like the Bitcoin code, except that I now have two assets. I am only doing one simulation for each asset, so two total simulations.</p>
<p>How do we simulative prices? Let me remind you of a formula:</p>
<div class="amsmath math notranslate nohighlight" id="equation-06bfea92-213a-4c4d-be3d-872e5ea99f45">
<span class="eqno">(13.2)<a class="headerlink" href="#equation-06bfea92-213a-4c4d-be3d-872e5ea99f45" title="Permalink to this equation">¶</a></span>\[\begin{align}
S(t) = S(0) \exp \left(\left(\mu - \frac{1}{2}\sigma^2\right)t + \sigma W(t)\right)
\end{align}\]</div>
<p>Take a starting price <span class="math notranslate nohighlight">\(S_0\)</span>. We use <code class="docutils literal notranslate"><span class="pre">exp</span></code> for continuous compounding. Then, the price today, <span class="math notranslate nohighlight">\(S_t\)</span> is a function of two return sources. The first source is called <strong>drift</strong>: <span class="math notranslate nohighlight">\(\mu - \frac{1}{2}\sigma^2\)</span>. This is what an asset returns on average over some period, like a day. This is the <strong>deterministic</strong> piece of the return and would be related to risk. <span class="math notranslate nohighlight">\(\mu\)</span> is the <strong>arithmetic average</strong> and <span class="math notranslate nohighlight">\(\sigma\)</span> is the volatility (standard deviation). They should be in the same units (e.g. daily).</p>
<p>The second piece of the return is the <strong>diffusion</strong>: <span class="math notranslate nohighlight">\(\sigma W(t)\)</span>. <span class="math notranslate nohighlight">\(W(t)\)</span> is called a <strong>Brownian motion</strong> and is, essentially, cumulative random wiggles. You multiply by <span class="math notranslate nohighlight">\(\sigma\)</span> to scale it: more volatility, more wiggles.</p>
<p><span class="math notranslate nohighlight">\(dW\)</span> denotes the random wiggle in just one period.</p>
<p>In this example, our random wiggles are going to be <strong>correlated</strong> across assets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">pdr</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mi">251</span> <span class="c1"># How long is our simulation? Let&#39;s do 252 days (0 to 251)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">251</span> <span class="c1"># number of time points in the prediction time horizon, making this the same as T means that we will simulate daily returns </span>

<span class="n">rho</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.80</span> <span class="c1"># Correlation between our two assets. Change me to get different patterns!</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.05</span><span class="o">/</span><span class="mi">252</span> <span class="c1"># Mean return (log). Using daily. </span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.12</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">252</span><span class="p">)</span>  <span class="c1"># Volatility of returns (standard deviation). Using daily. </span>
<span class="n">drift</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">**</span> <span class="mi">2</span> <span class="c1"># Drift is the same each day.</span>

<span class="n">S_0</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># Starting price</span>

<span class="n">dt</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="n">N</span> <span class="c1"># One day price movements</span>
<span class="n">dW</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">])</span> <span class="c1"># Set up random shocks with zeroes for now</span>

<span class="c1"># Sample two random variables from the standard normal distribution standard normal distribution. Two rows of 251 values from N(0,1).</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dt</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>

<span class="c1"># Generate correlated random shock, W. </span>
<span class="n">dW</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Same as first row in X</span>
<span class="n">dW</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rho</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Dependent on both sets of random values. How dependent? Correlation determines.</span>

<span class="c1">#An array containing the sum of random shocks for our assets.</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">dW</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

<span class="n">diffusion</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">W</span> <span class="c1"># This is CUMULATIVE diffusion returns over time, rather than daily diffusion returns. </span>

<span class="n">time_step</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="c1"># An array of 1, 2, 3, 4, 5..., keeping track of what time period we are in.</span>
<span class="n">time_steps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">time_step</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span> <span class="c1"># An array of 1, 2, 3, 4, 5..., but for each asset. </span>

<span class="c1"># This is taking the drift (mu - 0.5 * sigma ** 2), which is the same each day, and multiplying it by 1 on Day 1, 2 on Day 2, 3 on Day 3, etc. Then, that term has sigma (volatility) * the cumulative shock added to it. </span>
<span class="c1"># Then, Staring Price * e^(r) = Price Today, since r is really a cumulative return.</span>
<span class="n">S_t</span> <span class="o">=</span> <span class="n">S_0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">drift</span><span class="p">)</span> <span class="o">*</span> <span class="n">time_steps</span> <span class="o">+</span> <span class="n">diffusion</span><span class="p">)</span> 

<span class="n">S_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">S_t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">S_0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s plot the two sets of cumulative returns to see if they make sense.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sims</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">S_t</span><span class="p">))</span>

<span class="c1"># plotting</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sims</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Simulated Asset Returns with Correlation of -0.80&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/13_monte_carlo_5_0.png" src="../_images/13_monte_carlo_5_0.png" />
</div>
</div>
<p>You can really see the negative correlation!</p>
<p>Let’s move to some real data now. I am using <code class="docutils literal notranslate"><span class="pre">pandas</span> <span class="pre">data-reader</span></code> to bring in adjusted closing prices for five stocks. I then calculate discrete returns and check my descriptives.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ticker_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AAPL&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;FB&quot;</span><span class="p">,</span> <span class="s2">&quot;AMZN&quot;</span><span class="p">,</span> <span class="s2">&quot;XOM&quot;</span><span class="p">]</span>

<span class="n">stock_data</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="n">ticker_list</span><span class="p">,</span> <span class="s2">&quot;yahoo&quot;</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>

<span class="n">prices</span> <span class="o">=</span> <span class="n">stock_data</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span>

<span class="n">rets</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">sm</span><span class="o">/</span><span class="n">f4lq92s11392x68kwf0scq3w0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_89910</span><span class="o">/</span><span class="mf">2771594103.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">ticker_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AAPL&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;FB&quot;</span><span class="p">,</span> <span class="s2">&quot;AMZN&quot;</span><span class="p">,</span> <span class="s2">&quot;XOM&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> 
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="n">stock_data</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="n">ticker_list</span><span class="p">,</span> <span class="s2">&quot;yahoo&quot;</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> 
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">prices</span> <span class="o">=</span> <span class="n">stock_data</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span>

<span class="nn">~/opt/anaconda3/lib/python3.9/site-packages/pandas/util/_decorators.py</span> in <span class="ni">wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">205</span>                 <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">206</span>                     <span class="n">kwargs</span><span class="p">[</span><span class="n">new_arg_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_arg_value</span>
<span class="ne">--&gt; </span><span class="mi">207</span>             <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">208</span> 
<span class="g g-Whitespace">    </span><span class="mi">209</span>         <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">wrapper</span><span class="p">)</span>

<span class="nn">~/opt/anaconda3/lib/python3.9/site-packages/pandas_datareader/data.py</span> in <span class="ni">DataReader</span><span class="nt">(name, data_source, start, end, retry_count, pause, session, api_key)</span>
<span class="g g-Whitespace">    </span><span class="mi">368</span> 
<span class="g g-Whitespace">    </span><span class="mi">369</span>     <span class="k">if</span> <span class="n">data_source</span> <span class="o">==</span> <span class="s2">&quot;yahoo&quot;</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">370</span>         <span class="k">return</span> <span class="n">YahooDailyReader</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">371</span>             <span class="n">symbols</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">372</span>             <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span>

<span class="nn">~/opt/anaconda3/lib/python3.9/site-packages/pandas_datareader/base.py</span> in <span class="ni">read</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">256</span>             <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dl_mult_symbols</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">257</span>         <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">258</span>             <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dl_mult_symbols</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">259</span>         <span class="k">return</span> <span class="n">df</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span> 

<span class="nn">~/opt/anaconda3/lib/python3.9/site-packages/pandas_datareader/base.py</span> in <span class="ni">_dl_mult_symbols</span><span class="nt">(self, symbols)</span>
<span class="g g-Whitespace">    </span><span class="mi">266</span>             <span class="k">for</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">sym_group</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">267</span>                 <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">268</span>                     <span class="n">stocks</span><span class="p">[</span><span class="n">sym</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_one_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_params</span><span class="p">(</span><span class="n">sym</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">269</span>                     <span class="n">passed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">270</span>                 <span class="k">except</span> <span class="p">(</span><span class="ne">IOError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">):</span>

<span class="nn">~/opt/anaconda3/lib/python3.9/site-packages/pandas_datareader/yahoo/daily.py</span> in <span class="ni">_read_one_data</span><span class="nt">(self, url, params)</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span>         <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">152</span>             <span class="n">j</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">ptrn</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="ne">--&gt; </span><span class="mi">153</span>             <span class="n">data</span> <span class="o">=</span> <span class="n">j</span><span class="p">[</span><span class="s2">&quot;context&quot;</span><span class="p">][</span><span class="s2">&quot;dispatcher&quot;</span><span class="p">][</span><span class="s2">&quot;stores&quot;</span><span class="p">][</span><span class="s2">&quot;HistoricalPriceStore&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">154</span>         <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">155</span>             <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;No data fetched for symbol </span><span class="si">{}</span><span class="s2"> using </span><span class="si">{}</span><span class="s2">&quot;</span>

<span class="ne">TypeError</span>: string indices must be integers
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rets</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Symbols</th>
      <th>AAPL</th>
      <th>F</th>
      <th>FB</th>
      <th>AMZN</th>
      <th>XOM</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-03</th>
      <td>-0.099607</td>
      <td>-0.015190</td>
      <td>-0.029039</td>
      <td>-0.025242</td>
      <td>-0.015354</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>0.042689</td>
      <td>0.038560</td>
      <td>0.047138</td>
      <td>0.050064</td>
      <td>0.036870</td>
    </tr>
    <tr>
      <th>2019-01-07</th>
      <td>-0.002226</td>
      <td>0.025990</td>
      <td>0.000725</td>
      <td>0.034353</td>
      <td>0.005200</td>
    </tr>
    <tr>
      <th>2019-01-08</th>
      <td>0.019063</td>
      <td>0.009650</td>
      <td>0.032452</td>
      <td>0.016612</td>
      <td>0.007271</td>
    </tr>
    <tr>
      <th>2019-01-09</th>
      <td>0.016982</td>
      <td>0.041816</td>
      <td>0.011927</td>
      <td>0.001714</td>
      <td>0.005274</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2019-12-24</th>
      <td>0.000951</td>
      <td>0.003178</td>
      <td>-0.005141</td>
      <td>-0.002114</td>
      <td>-0.003841</td>
    </tr>
    <tr>
      <th>2019-12-26</th>
      <td>0.019840</td>
      <td>-0.002112</td>
      <td>0.013017</td>
      <td>0.044467</td>
      <td>0.001571</td>
    </tr>
    <tr>
      <th>2019-12-27</th>
      <td>-0.000380</td>
      <td>-0.009524</td>
      <td>0.001492</td>
      <td>0.000551</td>
      <td>-0.003422</td>
    </tr>
    <tr>
      <th>2019-12-30</th>
      <td>0.005935</td>
      <td>-0.011752</td>
      <td>-0.017732</td>
      <td>-0.012253</td>
      <td>-0.005866</td>
    </tr>
    <tr>
      <th>2019-12-31</th>
      <td>0.007306</td>
      <td>0.005405</td>
      <td>0.004109</td>
      <td>0.000514</td>
      <td>0.004318</td>
    </tr>
  </tbody>
</table>
<p>251 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rets</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Symbols</th>
      <th>AAPL</th>
      <th>F</th>
      <th>FB</th>
      <th>AMZN</th>
      <th>XOM</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>251.000000</td>
      <td>251.000000</td>
      <td>251.000000</td>
      <td>251.000000</td>
      <td>251.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.002671</td>
      <td>0.001053</td>
      <td>0.001801</td>
      <td>0.000832</td>
      <td>0.000257</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.016498</td>
      <td>0.017158</td>
      <td>0.017471</td>
      <td>0.014382</td>
      <td>0.011499</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-0.099607</td>
      <td>-0.074540</td>
      <td>-0.075055</td>
      <td>-0.053819</td>
      <td>-0.040289</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.004820</td>
      <td>-0.006961</td>
      <td>-0.006984</td>
      <td>-0.006649</td>
      <td>-0.006711</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.002768</td>
      <td>0.000964</td>
      <td>0.001001</td>
      <td>0.001163</td>
      <td>0.000694</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.011560</td>
      <td>0.010034</td>
      <td>0.011429</td>
      <td>0.008535</td>
      <td>0.007802</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.068335</td>
      <td>0.107447</td>
      <td>0.108164</td>
      <td>0.050064</td>
      <td>0.036870</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Seems legit! The average daily returns are all positive, but around zero. The worst daily return is an Apple return of -9.96%. Each stock has a count of 251 daily returns over the course of the year.</p>
<p>OK, now it’s time to set up our simulation. We will do 50 different future portfolio paths. We’ll simulate 252 days worth of prices. We’ll use these prices to find returns.</p>
<p>We are simulating random numbers. But, computers cant <em>really</em> generate truly random numbers. We can set a <strong>seed</strong> value that will always generate the same set of random values.</p>
<p><code class="docutils literal notranslate"><span class="pre">mu</span></code> has our arithmetic average returns.</p>
<p>We then find our usual variance-covariance matrix using <code class="docutils literal notranslate"><span class="pre">.cov()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1986</span><span class="p">)</span>

<span class="n">T</span> <span class="o">=</span> <span class="mi">252</span> <span class="c1"># How long is our simulation? Let&#39;s do 252 days.</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">252</span> <span class="c1"># number of time points in the prediction time horizon, making this the same as T means that we will simulate daily returns </span>
<span class="n">N_SIM</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># How many simulations to run?</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="n">N</span> <span class="c1"># daily steps</span>
<span class="n">noa</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># Number of assets</span>

<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">noa</span> <span class="o">*</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">noa</span><span class="p">,])</span>  <span class="c1"># EW portfolio based on number of assets. You can change this array to have any weights you want.</span>

<span class="n">mu</span> <span class="o">=</span> <span class="n">rets</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">cov</span> <span class="o">=</span> <span class="n">rets</span><span class="o">.</span><span class="n">cov</span><span class="p">()</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">rets</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">corr</span> <span class="o">=</span> <span class="n">rets</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="c1"># initial matrix</span>
<span class="n">port_returns_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_SIM</span><span class="p">),</span> <span class="mf">0.</span><span class="p">)</span> <span class="c1"># One less return than price</span>
</pre></div>
</div>
</div>
</div>
<p>We can look at the actual correlations among our assets to get a sense of what we are using to form portfolios.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Symbols</th>
      <th>AAPL</th>
      <th>F</th>
      <th>FB</th>
      <th>AMZN</th>
      <th>XOM</th>
    </tr>
    <tr>
      <th>Symbols</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AAPL</th>
      <td>1.000000</td>
      <td>0.305896</td>
      <td>0.475798</td>
      <td>0.592888</td>
      <td>0.416556</td>
    </tr>
    <tr>
      <th>F</th>
      <td>0.305896</td>
      <td>1.000000</td>
      <td>0.280101</td>
      <td>0.364217</td>
      <td>0.375396</td>
    </tr>
    <tr>
      <th>FB</th>
      <td>0.475798</td>
      <td>0.280101</td>
      <td>1.000000</td>
      <td>0.616672</td>
      <td>0.338376</td>
    </tr>
    <tr>
      <th>AMZN</th>
      <td>0.592888</td>
      <td>0.364217</td>
      <td>0.616672</td>
      <td>1.000000</td>
      <td>0.370257</td>
    </tr>
    <tr>
      <th>XOM</th>
      <td>0.416556</td>
      <td>0.375396</td>
      <td>0.338376</td>
      <td>0.370257</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s start with a simple case. We’ll simulate one series of returns for each of our assets, but include <strong>correlated shocks</strong>. We’ll get returns by actually simulating prices and then calculating returns.</p>
<p>The first line picks out he latest prices for each stock. This is where we will start. You could start each stock at $1 and get the same return result, since it’s the change that matters.</p>
<p>The second line is our <strong>math magic</strong>. This takes our variance-covariance matrix and does something called the <strong>Cholesky Decomposition</strong>. The variance-covariance matrix contains the information for how our assets move together (i.e. covariance). This method will allow us to use the <strong>correlation among our assets</strong> when simulating the random price paths. We want correlated assets to move together. You can read more about these methods <a class="reference external" href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=4066115">here</a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code> is a <span class="math notranslate nohighlight">\(5\times5\)</span> matrix, just like the variance-covariance matrix, but the upper triangular part is all zeroes, while the lower triangular part still contains the dependencies among our assets.</p>
<p><code class="docutils literal notranslate"><span class="pre">S</span></code> is 252 days of “empty” prices for our 5 assets. Why 252? We want our starting price plus 251 days of simulated prices. We’ll fill these in with simulated prices. We make the first price in the array equal to the latest price.</p>
<p>Then, we have a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop that simulates prices for each asset across all 252 days. Ranges in Python start at and include the first, but stop one before the last number. Why do we start at 1? S[:, 0] are our initial prices. See how the fourth line has <code class="docutils literal notranslate"><span class="pre">i-1</span></code>. So, the first time through, it will use the starting price <code class="docutils literal notranslate"><span class="pre">S[:,1-1]</span></code>, or <code class="docutils literal notranslate"><span class="pre">S[:,0]</span></code>, to find the first simulated price <code class="docutils literal notranslate"><span class="pre">S[:,1]</span></code>. The loop will then go to 252 and stop one before, or 251. This gives us a starting price plus 251 daily simulated prices. Counting isn’t always easy!</p>
<p>We first calculate the <strong>drift</strong>, or deterministic component, of the return. This is based on the mean and standard deviation of the returns. <code class="docutils literal notranslate"><span class="pre">dt</span></code> is just 1 day in this case.</p>
<p>We then pull 5 random variables, one for each asset, from the standard normal distribution. We’ll call these 5 numbers <code class="docutils literal notranslate"><span class="pre">Z</span></code>.</p>
<p>If you multiply <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">Z</span></code>, then you get correlated standard normal variables, instead of five sets of random variables with no relationships among them.</p>
<p>The last line in the <code class="docutils literal notranslate"><span class="pre">for</span></code> loop is again how we simulate prices. I have done the drift (deterministic) and diffusion (random) terms separately to make it easier to see what’s going on. With this type of simulation, the stock price today is the stock price yesterday times <span class="math notranslate nohighlight">\(\exp(\text{drift} + \text{diffusion})\)</span>. This is <strong>continuous compounding</strong>.</p>
<p>I take these prices and calculate returns again. But, these are now one set of simulated returns.</p>
<p>Finally, I take the returns and multiply them by our chosen weights to get a single set of <strong>portfolio returns</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S_0</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">noa</span><span class="p">,</span> <span class="n">N</span><span class="p">])</span> <span class="c1"># Why N+1? We want our starting price + 252 days of prices.</span>
<span class="n">S</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">S_0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>    
    <span class="n">drift</span> <span class="o">=</span> <span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span> <span class="c1"># dt = 1. This is the deterministic part of the daily return. It&#39;s the same every day.</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">noa</span><span class="p">)</span> <span class="c1"># Putting as period after a number in Python makes division work correctly when dealing with integers. Not sure we even need it here.</span>
    <span class="n">diffusion</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span> <span class="c1"># dt = 1. This is the random part. </span>
    <span class="n">S</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">drift</span> <span class="o">+</span> <span class="n">diffusion</span><span class="p">)</span> <span class="c1"># S_t = S_t-1 * e^(r). Continuous compounding, where r is just that day&#39;s return, rather than a cumulative return. </span>

<span class="n">R</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span> <span class="c1"># Create returns from those simulated prices.</span>

<span class="n">port_rets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumprod</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># Weights x returns, cumulative product to get cumulative portfolio returns.</span>
</pre></div>
</div>
</div>
</div>
<p>This method is coded up a bit differently from the two-asset and BTC example. There are no <code class="docutils literal notranslate"><span class="pre">timesteps</span></code>. Instead, <code class="docutils literal notranslate"><span class="pre">dt</span></code> = 1. Each previous stock return S_t-1 is being multiplied by a single daily return (drift+diffusion), rather than a cumulative return.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>I recommend running each line separately and then looking at the resulting variable/array. This is how you can figure out what’s going on in the simulation.</p>
</div>
<p>Let’s check the correlations and descriptives for these simulated returns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.000000</td>
      <td>0.313334</td>
      <td>0.550335</td>
      <td>0.609199</td>
      <td>0.498667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.313334</td>
      <td>1.000000</td>
      <td>0.329610</td>
      <td>0.398792</td>
      <td>0.419703</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.550335</td>
      <td>0.329610</td>
      <td>1.000000</td>
      <td>0.678113</td>
      <td>0.427324</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.609199</td>
      <td>0.398792</td>
      <td>0.678113</td>
      <td>1.000000</td>
      <td>0.399526</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.498667</td>
      <td>0.419703</td>
      <td>0.427324</td>
      <td>0.399526</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>251.000000</td>
      <td>251.000000</td>
      <td>251.000000</td>
      <td>251.000000</td>
      <td>251.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.001904</td>
      <td>0.000608</td>
      <td>0.000514</td>
      <td>-0.000338</td>
      <td>0.000021</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.016625</td>
      <td>0.017472</td>
      <td>0.018663</td>
      <td>0.015056</td>
      <td>0.012089</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-0.045377</td>
      <td>-0.041871</td>
      <td>-0.050829</td>
      <td>-0.040945</td>
      <td>-0.035468</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.010133</td>
      <td>-0.010410</td>
      <td>-0.012491</td>
      <td>-0.010318</td>
      <td>-0.008273</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.001480</td>
      <td>-0.000589</td>
      <td>-0.001766</td>
      <td>0.000222</td>
      <td>0.000387</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.010484</td>
      <td>0.013565</td>
      <td>0.011547</td>
      <td>0.009395</td>
      <td>0.007670</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.045815</td>
      <td>0.042183</td>
      <td>0.055264</td>
      <td>0.039023</td>
      <td>0.035685</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>They seem to make sense! The simulated correlations, in particular, are close to the empirical correlations.</p>
<p>Finally, let’s add <strong>one more element to this loop</strong>. We can find 50 different portfolio returns by wrapping the code above in another <code class="docutils literal notranslate"><span class="pre">for</span></code> loop.</p>
<p>The first loop is counting a bit differently. Our first simulation is indexed at 0 in Python. We will go up to, but not include the number of simulations we are doing. So, 0 through 49. This gives us 50 total simulations.</p>
<p>Remember, the <strong>indentation</strong> matters! It tells us how the loops are <strong>nested</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S_0</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">noa</span><span class="p">,</span> <span class="n">N</span><span class="p">])</span>
<span class="n">S</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">S_0</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N_SIM</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>    
        <span class="n">drift</span> <span class="o">=</span> <span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span> 
        <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">noa</span><span class="p">)</span> 
        <span class="n">diffusion</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span> 
        <span class="n">S</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">drift</span> <span class="o">+</span> <span class="n">diffusion</span><span class="p">)</span> 

        <span class="n">R</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

        <span class="n">port_rets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumprod</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">port_returns_all</span><span class="p">[:,</span> <span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">port_rets</span>
</pre></div>
</div>
</div>
</div>
<p>I don’t claim that this is elegant code. I’m sure there’s a better way to do this via vectorization, without loops. I’ll figure it out!</p>
<p>Let’s graph these 50 different portfolio paths to see what our future may hold.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">port_returns_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">port_returns_all</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">port_returns_all</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Portfolio Returns&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Days&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Simulated Portfolio Returns For 252 days&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/13_monte_carlo_23_0.png" src="../_images/13_monte_carlo_23_0.png" />
</div>
</div>
<p>That’s a large spread of possible cumulative portfolio returns over the year! This type of simulation is potentially useful for financial planners, and let’s you “answer” questions like, “What’s the probability that my portfolio falls below a particular level over the next decade?”. You can also use price paths like this to price certain options, where the value of the option depends on the paths that a basket of stocks took.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="12_risk_mang.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">12. </span>Risk management</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="14_options.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">14. </span>Option basics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Prof. Adam Aiken<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>