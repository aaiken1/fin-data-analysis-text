
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>8. Essential portfolio math &#8212; Data Analysis in Finance</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="9. Portfolio optimization" href="9_portfolio_opt.html" />
    <link rel="prev" title="7. Using NASDAQ BTC data" href="7_nasdaq_api.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/cat.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Data Analysis in Finance</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1_finpyth.html">
   1. Why Python and finance?
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="2_intro.html">
   2. Python set-up
   <a id="python_set-up">
   </a>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="2_0_install.html">
     2.2. Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_1_jupyter.html">
     2.3. Jupyter notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_2_vscode.html">
     2.4. VS Code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_3_markdown.html">
     2.5. Markdown
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_4_packages.html">
     2.6. Packages
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The Basics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="3_intro.html">
   3. CompSci 101: Types, control, and numpy arrays
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="3_0_comp101.html">
     3.1. The Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="3_1_numpy.html">
     3.2. Numpy and arrays
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="4_intro.html">
   4. Pandas and data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="4_0_dataframes.html">
     4.1. Data importing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_1_pandas.html">
     4.2. pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_2_cleaning_data.html">
     4.3. Cleaning our data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_3_eda.html">
     4.4. Exploratory data analysis (EDA)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_4_merge_shape.html">
     4.5. Merging and reshaping data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="5_intro.html">
   5. Data visualization
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="5_0_matplotlib.html">
     5.2. matplotlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="5_1_plotly.html">
     5.3. plotly
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="5_2_seaborn.html">
     5.4. seaborn
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6_financial_ts.html">
   6. Financial time series
   <a id="financial-time-series">
   </a>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Applications
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="7_nasdaq_api.html">
   7. Using NASDAQ BTC data
   <a id="btc-sim">
   </a>
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   8. Essential portfolio math
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="9_portfolio_opt.html">
   9. Portfolio optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10_factor_models.html">
   10. Factor models
   <a id="factor_models">
   </a>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11_regression_topics.html">
   11. Regression topics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12_risk_mang.html">
   12. Risk management
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13_monte_carlo.html">
   13. Monte Carlo and portfolios
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14_options.html">
   14. Option basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="15_logit_credit.html">
   15. Logit models
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Labs
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="lab_intro.html">
   Our labs
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Exams
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="exam_intro.html">
   Our Exams
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/chapters/8_port_math.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapters/8_port_math.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#geometric-vs-arithmetic-averages">
   8.1. Geometric vs. arithmetic averages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#portfolio-level-returns">
   8.2. Portfolio-level returns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#risk-measures-at-the-portfolio-level">
   8.3. Risk measures at the portfolio-level
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#skewness-and-kurtosis">
   8.4. Skewness and kurtosis
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#annualizing-and-adjusting-for-risk">
   8.5. Annualizing and adjusting for risk
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#drawdowns">
   8.6. Drawdowns
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Essential portfolio math</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#geometric-vs-arithmetic-averages">
   8.1. Geometric vs. arithmetic averages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#portfolio-level-returns">
   8.2. Portfolio-level returns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#risk-measures-at-the-portfolio-level">
   8.3. Risk measures at the portfolio-level
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#skewness-and-kurtosis">
   8.4. Skewness and kurtosis
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#annualizing-and-adjusting-for-risk">
   8.5. Annualizing and adjusting for risk
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#drawdowns">
   8.6. Drawdowns
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="essential-portfolio-math">
<h1><span class="section-number">8. </span>Essential portfolio math<a class="headerlink" href="#essential-portfolio-math" title="Permalink to this headline">#</a></h1>
<p>This brief chapter will cover the type of statistics that we often see when looking at <strong>portfolios</strong>. Much of this material is covered in various DataCamp exercises. Parts of the material, such as skewness and kurtosis, are also covered in <strong>Chapter 13 of our textbook</strong>.</p>
<p>This material will have us thinking about <strong>portfolio construction</strong>.</p>
<p>What is <strong>portfolio construction</strong>? Choosing and sizing the various trades (or, assets, more generally) to achieve a good trade-off between risk and expected return.</p>
<ol class="simple">
<li><p>Diversification</p></li>
<li><p>Position limits and risk limits: At the level of securities, asset classes, and overall portfolio.</p></li>
<li><p>Larger bets on higher conviction trade.</p></li>
<li><p>Size bets in terms of risk</p></li>
<li><p>Correlations matter: For a long position, correlation with other longs is bad, corr. with shorts is good. Powerful to go long/short within each industry, diversify across industries. Can use ETFs and futures to “hedge” out sector and market exposure.</p></li>
<li><p>Resize positions according to forward-looking risk and conviction</p></li>
</ol>
<p>We’ll start by bringing in some <strong>monthly hedge fund return data</strong>. We’ll calculate some portfolio returns, using assumed weights. We’ll then move on to portfolio-level <strong>variance and standard deviation</strong>. We’ll see how to <strong>annualize returns and volatility</strong>. We’ll look at other risk measures, like <strong>skewness</strong> and <strong>kurtosis</strong>. We’ll see <strong>Sharpe</strong> and <strong>Sortino</strong> ratios. Finally, we’ll make a graph showing the <strong>drawdown</strong>, or worse loss, of our portfolio.</p>
<p>These ideas will get us thinking about portfolios, trading strategies, risk management, and portfolio optimization. We’ll go into more detail in later chapters.</p>
<p>The formulas are <strong>must knows</strong> for finance folks! For example, you need these on CFA Level 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="kn">import</span> <span class="nn">janitor</span>
<span class="kn">from</span> <span class="nn">janitor</span> <span class="kn">import</span> <span class="n">clean_names</span>

<span class="c1"># This brings in all of matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span> 

<span class="c1"># This lets us refer to the pyplot part of matplot lib more easily. Just use plt!</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">hf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/aaiken1/fin-data-analysis-python/main/data/hf_rets.xlsx&#39;</span><span class="p">,</span>
                  <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  

<span class="n">hf</span> <span class="o">=</span> <span class="n">hf</span><span class="o">.</span><span class="n">clean_names</span><span class="p">()</span>

<span class="n">hf</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rf</th>
      <th>mkt_rf</th>
      <th>smb</th>
      <th>hml</th>
      <th>umd</th>
      <th>ln_sh_eq_hedge_fund_usd</th>
      <th>eq_mkt_ntr_hedge_fund_usd</th>
      <th>ded_sh_bs_hedge_fund_usd</th>
      <th>global_mac_hedge_fund_usd</th>
      <th>mngd_fut_hedge_fund_usd</th>
      <th>emg_mkts_hedge_fund_usd</th>
      <th>evnt_drvn_hedge_fund_usd</th>
      <th>_cnvrt_arb_hedge_fund_usd</th>
      <th>fx_inc_arb_hedge_fund_usd</th>
      <th>djcs_hedge_fund_usd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>222.000000</td>
      <td>222.000000</td>
      <td>222.000000</td>
      <td>222.000000</td>
      <td>222.000000</td>
      <td>222.000000</td>
      <td>222.000000</td>
      <td>222.000000</td>
      <td>222.000000</td>
      <td>222.000000</td>
      <td>222.000000</td>
      <td>222.000000</td>
      <td>222.000000</td>
      <td>222.000000</td>
      <td>222.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.002536</td>
      <td>0.005089</td>
      <td>0.002121</td>
      <td>0.002133</td>
      <td>0.004886</td>
      <td>0.007535</td>
      <td>0.004410</td>
      <td>-0.002217</td>
      <td>0.009594</td>
      <td>0.005108</td>
      <td>0.006656</td>
      <td>0.007360</td>
      <td>0.006129</td>
      <td>0.004366</td>
      <td>0.007011</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.001742</td>
      <td>0.047007</td>
      <td>0.035581</td>
      <td>0.033738</td>
      <td>0.054827</td>
      <td>0.028745</td>
      <td>0.029770</td>
      <td>0.049144</td>
      <td>0.028000</td>
      <td>0.033738</td>
      <td>0.042929</td>
      <td>0.018291</td>
      <td>0.019981</td>
      <td>0.016485</td>
      <td>0.021820</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>-0.185500</td>
      <td>-0.166200</td>
      <td>-0.128700</td>
      <td>-0.347500</td>
      <td>-0.114806</td>
      <td>-0.404590</td>
      <td>-0.112825</td>
      <td>-0.115652</td>
      <td>-0.093702</td>
      <td>-0.230716</td>
      <td>-0.118201</td>
      <td>-0.126007</td>
      <td>-0.140442</td>
      <td>-0.075948</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000900</td>
      <td>-0.023225</td>
      <td>-0.019750</td>
      <td>-0.015275</td>
      <td>-0.011225</td>
      <td>-0.008805</td>
      <td>0.001250</td>
      <td>-0.033677</td>
      <td>-0.001949</td>
      <td>-0.018947</td>
      <td>-0.012924</td>
      <td>0.000110</td>
      <td>-0.000482</td>
      <td>0.001716</td>
      <td>-0.002376</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.003000</td>
      <td>0.011550</td>
      <td>-0.001450</td>
      <td>0.002150</td>
      <td>0.006300</td>
      <td>0.007663</td>
      <td>0.006715</td>
      <td>-0.007478</td>
      <td>0.010404</td>
      <td>0.003235</td>
      <td>0.012111</td>
      <td>0.009848</td>
      <td>0.009817</td>
      <td>0.007131</td>
      <td>0.007447</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.004100</td>
      <td>0.035600</td>
      <td>0.023025</td>
      <td>0.017750</td>
      <td>0.030425</td>
      <td>0.023168</td>
      <td>0.012581</td>
      <td>0.029215</td>
      <td>0.021420</td>
      <td>0.028790</td>
      <td>0.028144</td>
      <td>0.018590</td>
      <td>0.014712</td>
      <td>0.011529</td>
      <td>0.018074</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.005600</td>
      <td>0.115300</td>
      <td>0.220600</td>
      <td>0.138800</td>
      <td>0.184000</td>
      <td>0.129913</td>
      <td>0.036573</td>
      <td>0.226661</td>
      <td>0.105808</td>
      <td>0.099063</td>
      <td>0.164018</td>
      <td>0.042168</td>
      <td>0.058055</td>
      <td>0.043331</td>
      <td>0.085117</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>There’s a lot there, so let’s just keep four different columns. These columns represent the average monthly return for that hedge fund type. I’m keeping long/short equity, equity market neutral, global macro, managed futures.</p>
<p>Long/short equity funds do what the name says – they go long and short stocks, generally keeping their market beta less than one. But not that different from traditional mutual funds.</p>
<p>Equity market neutral might aim for a beta of zero, but usually have more exposure than that. They are trying to get rid of their risk exposures and just earn alpha from security mispricings. Easier said than done.</p>
<p>Global macro funds make trades based on broad market trends, currencies, and other markets affected by macro events, like inflation or economic growth. They don’t buy or sell individual stocks and often use futures contracts to get their exposures.</p>
<p>Finally, managed futures are similar, but tend to follow trend-following strategies. They buy stuff that’s been going up and sell stuff that’s been going down. Some investors use them as diversifiers in their portfolios.</p>
<p>You’ll see more on these ideas in the factor model notes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rets</span> <span class="o">=</span> <span class="n">hf</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="n">rets</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ln_sh_eq_hedge_fund_usd</th>
      <th>eq_mkt_ntr_hedge_fund_usd</th>
      <th>global_mac_hedge_fund_usd</th>
      <th>mngd_fut_hedge_fund_usd</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1994-01-31</th>
      <td>0.011733</td>
      <td>-0.005467</td>
      <td>0.001433</td>
      <td>0.001933</td>
    </tr>
    <tr>
      <th>1994-02-28</th>
      <td>-0.025011</td>
      <td>0.002106</td>
      <td>-0.056811</td>
      <td>0.011667</td>
    </tr>
    <tr>
      <th>1994-03-31</th>
      <td>-0.039114</td>
      <td>-0.002514</td>
      <td>-0.042854</td>
      <td>0.025923</td>
    </tr>
    <tr>
      <th>1994-04-29</th>
      <td>-0.015720</td>
      <td>0.002397</td>
      <td>-0.016033</td>
      <td>0.008437</td>
    </tr>
    <tr>
      <th>1994-05-31</th>
      <td>0.005550</td>
      <td>-0.001229</td>
      <td>0.037839</td>
      <td>0.007497</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2012-02-29</th>
      <td>0.026418</td>
      <td>0.013335</td>
      <td>0.007852</td>
      <td>0.012039</td>
    </tr>
    <tr>
      <th>2012-03-30</th>
      <td>0.004998</td>
      <td>-0.001553</td>
      <td>-0.004271</td>
      <td>-0.029648</td>
    </tr>
    <tr>
      <th>2012-04-30</th>
      <td>-0.004680</td>
      <td>-0.004139</td>
      <td>-0.002522</td>
      <td>0.004299</td>
    </tr>
    <tr>
      <th>2012-05-31</th>
      <td>-0.045274</td>
      <td>-0.031806</td>
      <td>0.001936</td>
      <td>0.023829</td>
    </tr>
    <tr>
      <th>2012-06-29</th>
      <td>0.003438</td>
      <td>0.009249</td>
      <td>-0.013726</td>
      <td>-0.035612</td>
    </tr>
  </tbody>
</table>
<p>222 rows × 4 columns</p>
</div></div></div>
</div>
<p>I used <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> to keep the columns I wanted. Easier to use a column number reference than type out these long names.</p>
<section id="geometric-vs-arithmetic-averages">
<h2><span class="section-number">8.1. </span>Geometric vs. arithmetic averages<a class="headerlink" href="#geometric-vs-arithmetic-averages" title="Permalink to this headline">#</a></h2>
<p>In order to think about portfolio returns, we also need to understand the relationship between an arithmetic average and the geometric average, and when to use one vs. another.</p>
<p>This article, <a class="reference external" href="https://www.kitces.com/blog/volatility-drag-variance-drain-mean-arithmetic-vs-geometric-average-investment-returns/">by the financial planner Michael Kitches</a>, is a great explanation of why the difference matters and how <strong>volatility drag</strong> affects your total return. From his summary:</p>
<blockquote>
<div><p>In the investment world, it’s common to discuss average rates of return, both in a backward-looking fashion (e.g., to report investment results), and in a more forward-looking manner (e.g., to project the average growth rate of investments for funding future goals in retirement planning software). However, the reality is that because returns are linked to each other – the return in one year increases or decreases the available wealth to compound in the subsequent year – it’s not sufficient to simply determine an “average” return by adding up all the historical returns and dividing by how many there are.</p>
</div></blockquote>
<blockquote>
<div><p>Instead of this traditional “arithmetic mean” approach to calculating an average, in the case of investment returns, the proper way to calculate average returns is with a geometric mean, that takes into account the compounding effects of a series of volatile returns over time. Which is important, because in practice the geometric average return is never as high as its arithmetic mean counterpart, due to the fact that volatility always produces some level of “volatility drag”, which can be estimated by subtracting ½ of the investment’s variance (standard deviation squared) from its arithmetic return.</p>
</div></blockquote>
<blockquote>
<div><p>Fortunately, the reality is that most investment returns, as commonly discussed by financial advisors, are already reported as geometric returns, typically stated as either a Compound Average Growth Rate (CAGR), an annualized return, or some similar label. Which means, intended or not, most financial advisors already project future wealth values in a retirement plan using the (proper) geometric return assumption.</p>
</div></blockquote>
<blockquote>
<div><p>However, the variance drain on a sequence of volatile returns still matters when financial advisors use Monte Carlo analysis, which by design actually projects sequences of random volatile returns (based on the probability that they will occur) to determine the outcome of particular retirement strategies. Because the fact that volatility drag is already part of a Monte Carlo analysis means that the return assumption plugged into a Monte Carlo projection should actually be the (higher) arithmetic return, and not the investment’s long-term compound average growth rate. Otherwise, the impact of volatility drag is effectively counted twice, which can understate long-term returns and overstate the actual risk of the prospective retirement plan!</p>
</div></blockquote>
<p>We can put that reasoning into a simple, but important formula.</p>
<div class="amsmath math notranslate nohighlight" id="equation-fbbf2665-8659-454d-b8ea-91ab41527471">
<span class="eqno">(8.1)<a class="headerlink" href="#equation-fbbf2665-8659-454d-b8ea-91ab41527471" title="Permalink to this equation">#</a></span>\[\begin{align}
\text{Compound Return}_i = E[R_p] - \frac{1}{2}\sigma^2_p
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(E[R_i]\)</span> is the arithmetic mean of the portfolio (i.e. the expected return) and <span class="math notranslate nohighlight">\(\sigma^2_p\)</span> is the variance of the portfolio. Note that this math works for single assets, too. It isn’t portfolio specific.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>This is yet another formula that appears on the CFA and CFP exams.</p>
</div>
<p>Believe it or not, just figuring out how to calculate returns in order to create projections (e.g. for a client portfolio) is a controversial, non-trivial task. Two of the authors of your FIN 4120 investments textbook suggest that you should forecast the value of a portfolio using an average <a class="reference external" href="https://www.tandfonline.com/doi/abs/10.2469/faj.v59.n6.2574?src=recsys">between the arithmetic and geometric</a>.</p>
</section>
<section id="portfolio-level-returns">
<h2><span class="section-number">8.2. </span>Portfolio-level returns<a class="headerlink" href="#portfolio-level-returns" title="Permalink to this headline">#</a></h2>
<p>Let’s define an array of weights. We’ll put 25% of our money into each style category. This isn’t actually an investable strategy, since you can’t invest in the average hedge fund!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wgts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>We can find the monthly means for each strategy. I’ll multiply each by 100, name the column, and then turn the series into a DataFrame. You need the table to be a DataFrame in order to style it. I then use a <strong>dictionary</strong> to change the row names. Remember, a Python dictionary matches one item to another. I finally style the number format.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monthly_rets_avg</span> <span class="o">=</span> <span class="n">rets</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="n">monthly_rets_avg</span> <span class="o">=</span> <span class="n">monthly_rets_avg</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;Monthly Return&#39;</span><span class="p">)</span>

<span class="n">monthly_rets_avg</span> <span class="o">=</span> <span class="n">monthly_rets_avg</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>

<span class="n">monthly_rets_avg</span> <span class="o">=</span> <span class="n">monthly_rets_avg</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;ln_sh_eq_hedge_fund_usd&#39;</span><span class="p">:</span><span class="s1">&#39;L/S Equity&#39;</span><span class="p">,</span><span class="s1">&#39;eq_mkt_ntr_hedge_fund_usd&#39;</span><span class="p">:</span><span class="s1">&#39;Equity Market Neutral&#39;</span><span class="p">,</span><span class="s1">&#39;global_mac_hedge_fund_usd&#39;</span><span class="p">:</span><span class="s1">&#39;Global Macro&#39;</span><span class="p">,</span><span class="s1">&#39;mngd_fut_hedge_fund_usd&#39;</span><span class="p">:</span><span class="s1">&#39;Managed Futures&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;rows&#39;</span><span class="p">)</span>

<span class="n">monthly_rets_avg</span> <span class="o">=</span> <span class="n">monthly_rets_avg</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">%&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Hedge Fund Style Returns&#39;</span><span class="p">)</span> 

<span class="n">monthly_rets_avg</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_70845">
  <caption>Hedge Fund Style Returns</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_70845_level0_col0" class="col_heading level0 col0" >Monthly Return</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_70845_level0_row0" class="row_heading level0 row0" >L/S Equity</th>
      <td id="T_70845_row0_col0" class="data row0 col0" >0.754%</td>
    </tr>
    <tr>
      <th id="T_70845_level0_row1" class="row_heading level0 row1" >Equity Market Neutral</th>
      <td id="T_70845_row1_col0" class="data row1 col0" >0.441%</td>
    </tr>
    <tr>
      <th id="T_70845_level0_row2" class="row_heading level0 row2" >Global Macro</th>
      <td id="T_70845_row2_col0" class="data row2 col0" >0.959%</td>
    </tr>
    <tr>
      <th id="T_70845_level0_row3" class="row_heading level0 row3" >Managed Futures</th>
      <td id="T_70845_row3_col0" class="data row3 col0" >0.511%</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The <strong>method chaining</strong> to writing the code step-by-step to make the table works too. I find this easier to read. Note that I’m <strong>not</strong> saving the table as a DataFrame anywhere, though I could. I do one action and then the output gets passed on to the next action.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">rets</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;Monthly Return&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;ln_sh_eq_hedge_fund_usd&#39;</span><span class="p">:</span><span class="s1">&#39;L/S Equity&#39;</span><span class="p">,</span><span class="s1">&#39;eq_mkt_ntr_hedge_fund_usd&#39;</span><span class="p">:</span><span class="s1">&#39;Equity Market Neutral&#39;</span><span class="p">,</span><span class="s1">&#39;global_mac_hedge_fund_usd&#39;</span><span class="p">:</span><span class="s1">&#39;Global Macro&#39;</span><span class="p">,</span><span class="s1">&#39;mngd_fut_hedge_fund_usd&#39;</span><span class="p">:</span><span class="s1">&#39;Managed Futures&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;rows&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">style</span>
        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">%&#39;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Hedge Fund Style Returns&#39;</span><span class="p">)</span>   
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_446c7">
  <caption>Hedge Fund Style Returns</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_446c7_level0_col0" class="col_heading level0 col0" >Monthly Return</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_446c7_level0_row0" class="row_heading level0 row0" >L/S Equity</th>
      <td id="T_446c7_row0_col0" class="data row0 col0" >0.754%</td>
    </tr>
    <tr>
      <th id="T_446c7_level0_row1" class="row_heading level0 row1" >Equity Market Neutral</th>
      <td id="T_446c7_row1_col0" class="data row1 col0" >0.441%</td>
    </tr>
    <tr>
      <th id="T_446c7_level0_row2" class="row_heading level0 row2" >Global Macro</th>
      <td id="T_446c7_row2_col0" class="data row2 col0" >0.959%</td>
    </tr>
    <tr>
      <th id="T_446c7_level0_row3" class="row_heading level0 row3" >Managed Futures</th>
      <td id="T_446c7_row3_col0" class="data row3 col0" >0.511%</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We can also see what our equally-weighted portfolio would have done per month over that time period. I’ll remake the monthly average returns, since you can’t use it for math now that it’s been styled.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monthly_rets_avg</span> <span class="o">=</span> <span class="n">rets</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">hf_port_ret</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">monthly_rets_avg</span> <span class="o">*</span> <span class="n">wgts</span><span class="p">)</span>
<span class="n">hf_port_ret</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0066618444208333735
</pre></div>
</div>
</div>
</div>
<p>Let’s weight each month’s returns by our weights so that we can then calculate monthly portfolio returns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weighted_returns</span> <span class="o">=</span> <span class="p">(</span><span class="n">wgts</span> <span class="o">*</span> <span class="n">rets</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>I’m calculating monthly returns by summing up across each row. That’s the <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> argument. I’m then naming this series <em>port_ret</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">port_ret</span> <span class="o">=</span> <span class="n">weighted_returns</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;port_ret&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>I’ll join my portfolio returns to the monthly fund returns. There should be the same number of portfolio returns as individual hedge fund returns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rets_with_port</span> <span class="o">=</span> <span class="n">rets</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">port_ret</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And, I can calculate cumulative returns and then graph them. As we’ve seen using a function like <code class="docutils literal notranslate"><span class="pre">.cumprod()</span></code> like this is an example of <strong>broadcasting</strong> and <strong>vectorization</strong>. I am adding 1 to every monthly return and then applying the <code class="docutils literal notranslate"><span class="pre">.cumprod()</span></code> function to each observation. Take a look at the result to see what happened.</p>
<p>I’ll also rename the columns a slightly different way. Notice that I’m using <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> and have the column names inside of a <strong>dictionary</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monthly_cum_rets</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">rets_with_port</span><span class="p">)</span><span class="o">.</span><span class="n">cumprod</span><span class="p">()</span>
<span class="n">monthly_cum_rets</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ln_sh_eq_hedge_fund_usd&#39;</span><span class="p">:</span><span class="s1">&#39;L/S Equity&#39;</span><span class="p">,</span> <span class="s1">&#39;eq_mkt_ntr_hedge_fund_usd&#39;</span><span class="p">:</span><span class="s1">&#39;Equity Market Neutral&#39;</span><span class="p">,</span> <span class="s1">&#39;global_mac_hedge_fund_usd&#39;</span><span class="p">:</span><span class="s1">&#39;Global Macro&#39;</span><span class="p">,</span> <span class="s1">&#39;mngd_fut_hedge_fund_usd&#39;</span><span class="p">:</span><span class="s1">&#39;Managed Futures&#39;</span><span class="p">,</span> <span class="s1">&#39;port_ret&#39;</span><span class="p">:</span><span class="s1">&#39;EW Port Ret&#39;</span> <span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monthly_cum_rets</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8_port_math_22_0.png" src="../_images/8_port_math_22_0.png" />
</div>
</div>
<p>Yikes! Check out the orange line - equity market neutral funds aren’t necessarily very market neutral!</p>
</section>
<section id="risk-measures-at-the-portfolio-level">
<h2><span class="section-number">8.3. </span>Risk measures at the portfolio-level<a class="headerlink" href="#risk-measures-at-the-portfolio-level" title="Permalink to this headline">#</a></h2>
<p>As you know from your investments class, the variance of a portfolio is <strong>not</strong> the average variance of the assets in the portfolio. We need to take into account the effects of <strong>diversification</strong>. For example, here’s the formula for the variance of a portfolio with two assets. We need weights, variances, and the covariance between the two.</p>
<div class="amsmath math notranslate nohighlight" id="equation-b9281cc6-f909-42ac-b48a-3b64e43d4b95">
<span class="eqno">(8.2)<a class="headerlink" href="#equation-b9281cc6-f909-42ac-b48a-3b64e43d4b95" title="Permalink to this equation">#</a></span>\[\begin{align}
\sigma^2_p = w^2_1 \sigma^2_1 + w^2_2 \sigma^2_2 + 2 w_1 w_2 \sigma^2_{1,2}
\end{align}\]</div>
<p>That last sigma, <span class="math notranslate nohighlight">\(\sigma^2_{1,2}\)</span>, is the <strong>covariance</strong> between the two assets.</p>
<p>This formula generalizes for <strong>any number of assets</strong>.</p>
<div class="amsmath math notranslate nohighlight" id="equation-c24e2d43-5e4c-4495-b796-683e549d1217">
<span class="eqno">(8.3)<a class="headerlink" href="#equation-c24e2d43-5e4c-4495-b796-683e549d1217" title="Permalink to this equation">#</a></span>\[\begin{align}
\sigma^2_p = w^T \Sigma w
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(w\)</span> is a <strong>vector</strong> containing all of our portfolio weights and sigma is the variance-covariance matrix for our assets. The “T” means the matrix operation <strong>transpose</strong>. This is necessary for the matrix multiplication.</p>
<p>Let’s use Python to find the variance-covariance matrix. There are variances along with diagonal of the matrix and covariance terms <strong>between assets</strong> in the off-diagonals. Note that upper-right and lower-left of the matrix are identical. This is because the covariance between Asset 1 and Asset 2 is the same as the covariance between Asset 2 and Asset 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cov_matrix</span> <span class="o">=</span> <span class="n">rets</span><span class="o">.</span><span class="n">cov</span><span class="p">()</span>
<span class="n">cov_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ln_sh_eq_hedge_fund_usd</th>
      <th>eq_mkt_ntr_hedge_fund_usd</th>
      <th>global_mac_hedge_fund_usd</th>
      <th>mngd_fut_hedge_fund_usd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ln_sh_eq_hedge_fund_usd</th>
      <td>0.000826</td>
      <td>0.000192</td>
      <td>0.000362</td>
      <td>0.000066</td>
    </tr>
    <tr>
      <th>eq_mkt_ntr_hedge_fund_usd</th>
      <td>0.000192</td>
      <td>0.000886</td>
      <td>0.000069</td>
      <td>0.000005</td>
    </tr>
    <tr>
      <th>global_mac_hedge_fund_usd</th>
      <td>0.000362</td>
      <td>0.000069</td>
      <td>0.000784</td>
      <td>0.000283</td>
    </tr>
    <tr>
      <th>mngd_fut_hedge_fund_usd</th>
      <td>0.000066</td>
      <td>0.000005</td>
      <td>0.000283</td>
      <td>0.001138</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can also find the correlation matrix. Correlation (<span class="math notranslate nohighlight">\(\rho\)</span>) is the <strong>covariance between two assets divided by the standard deviation of each asset multiplied together</strong>: <span class="math notranslate nohighlight">\(\rho_{1,2} = \frac{\sigma_{1,2}}{\sigma_1 \sigma_2}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">rets</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">corr_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ln_sh_eq_hedge_fund_usd</th>
      <th>eq_mkt_ntr_hedge_fund_usd</th>
      <th>global_mac_hedge_fund_usd</th>
      <th>mngd_fut_hedge_fund_usd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ln_sh_eq_hedge_fund_usd</th>
      <td>1.000000</td>
      <td>0.224745</td>
      <td>0.450291</td>
      <td>0.068435</td>
    </tr>
    <tr>
      <th>eq_mkt_ntr_hedge_fund_usd</th>
      <td>0.224745</td>
      <td>1.000000</td>
      <td>0.083255</td>
      <td>0.005156</td>
    </tr>
    <tr>
      <th>global_mac_hedge_fund_usd</th>
      <td>0.450291</td>
      <td>0.083255</td>
      <td>1.000000</td>
      <td>0.299970</td>
    </tr>
    <tr>
      <th>mngd_fut_hedge_fund_usd</th>
      <td>0.068435</td>
      <td>0.005156</td>
      <td>0.299970</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The correlation among these general strategies is pretty low! That’s good for portfolio formation. In fact, strategies like managed futures are often considered a diversifier in a traditional equity and bond portfolio.</p>
<p>Let’s use our general formula, our weights, and the cov matrix to find <strong>portfolio variance</strong>. We’ll use <code class="docutils literal notranslate"><span class="pre">np.dot()</span></code> from <code class="docutils literal notranslate"><span class="pre">numpy</span></code> to do the dot product. This is like <strong>mmult</strong> in Excel. The <code class="docutils literal notranslate"><span class="pre">.T</span></code> transposes, or flips, the vector of returns so that we can multiply.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">port_variance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">wgts</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">cov_matrix</span><span class="p">,</span> <span class="n">wgts</span><span class="p">))</span>
<span class="n">port_variance</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0003495578603062863
</pre></div>
</div>
</div>
</div>
<p>Here’s a <a class="reference external" href="https://www.mathsisfun.com/algebra/matrix-multiplying.html">refresher on matrix multiplication</a> in case you need it.</p>
<p>Portfolio standard deviation is, of course, just the square root of variance. We can use <code class="docutils literal notranslate"><span class="pre">np.sqrt()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">port_stddev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">wgts</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">cov_matrix</span><span class="p">,</span> <span class="n">wgts</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">port_stddev</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.9%
</pre></div>
</div>
</div>
</div>
</section>
<section id="skewness-and-kurtosis">
<h2><span class="section-number">8.4. </span>Skewness and kurtosis<a class="headerlink" href="#skewness-and-kurtosis" title="Permalink to this headline">#</a></h2>
<p>We’ll look more at the distribution of asset returns when we get to a more formal treatment of risk management. But, for now, we need to know that asset returns, like stocks, and even portfolio returns, like those of a hedge fund, are not typically normally distributed. They “lean”, or have <strong>skewness</strong>. That skewness can be either positive or negative, depending on the strategy. They also have <strong>kurtosis</strong>, or “fat tails”. This means that there are more extreme returns than you would expect if they followed a normal distribution.</p>
<p>It is easy to find both in Python.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rets_with_port</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ln_sh_eq_hedge_fund_usd      -0.012623
eq_mkt_ntr_hedge_fund_usd   -11.866451
global_mac_hedge_fund_usd     0.016477
mngd_fut_hedge_fund_usd       0.026489
port_ret                     -0.386969
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>It’s easier to see what skewness and kurtosis mean with pictures.</p>
<figure class="align-center" id="skew-png">
<img alt="../_images/08-skew.png" src="../_images/08-skew.png" />
<figcaption>
<p><span class="caption-number">Fig. 8.1 </span><span class="caption-text">Some strategies, like selling options, have negative skewness. You make a small profit much of the time – until you don’t. Other investments have positive skewness. You’ll lose money much of the time, but occasionally get a large payoff. Some volatility-protection strategies look like this. Source: DataCamp.</span><a class="headerlink" href="#skew-png" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rets_with_port</span><span class="o">.</span><span class="n">kurt</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ln_sh_eq_hedge_fund_usd        3.186683
eq_mkt_ntr_hedge_fund_usd    162.760371
global_mac_hedge_fund_usd      3.888268
mngd_fut_hedge_fund_usd       -0.017587
port_ret                       3.306429
dtype: float64
</pre></div>
</div>
</div>
</div>
<figure class="align-center" id="kurt-png">
<img alt="../_images/08-kurt.png" src="../_images/08-kurt.png" />
<figcaption>
<p><span class="caption-number">Fig. 8.2 </span><span class="caption-text">Many investment strategies have more “rare events” or larger gains and losses than you would expect if returns followed the normal distribution. Source: DataCamp.</span><a class="headerlink" href="#kurt-png" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="annualizing-and-adjusting-for-risk">
<h2><span class="section-number">8.5. </span>Annualizing and adjusting for risk<a class="headerlink" href="#annualizing-and-adjusting-for-risk" title="Permalink to this headline">#</a></h2>
<p>There are many ways to report returns. We’ve seen discrete vs. log returns. There are returns for specific period, like a day or a month. We can then take that specific period return and <strong>annualize</strong> it. This takes a return over a shorter time frame and asks what are return would be if we earned that return over a year.</p>
<p>We can also annualize a multi-year return and ask what annual return would have gotten us the same multi-year return.</p>
<p>Both of these ideas are really the same thing mathematically and take into account <strong>compounding</strong>. They let us compare returns that are different time periods. Fund managers that fall under the SEC ‘40 Act are required to report calculations like this.</p>
<p>There are also many ways to <strong>adjust for risk</strong>. Why do we need to adjust for risk? Simply put, you can go to a casino and put all of your money on black, get lucky, and double your “investment”. But I don’t want you managing my money! Your risk-adjusted return is zero.</p>
<p>The same thing is true for trading securities, like stocks, bonds, options, and crypto. You can buy a penny stock, or a Dog coin, or a deep out-of-the-money call option and make a lot of money. And that money is real - you can spend it! But, we need ways to disentangle return, risk, and luck if we’re going to assign skill to someone’s good forture.</p>
<p>Let’s combine these two ideas, getting our return and risk measures in the same time units and taking risk into account, to calculate to basic risk-adjustment measures: the <strong>Sharpe Ratio</strong> and the <strong>Sortino Ratio</strong>.</p>
<p>We’ll look at <strong>factor models</strong> in another chapter. This is a more comprehensive way to adjust our returns for the risks that we’re taking in order to see if we have skill.</p>
<p>Let’s use the monthly portfolio returns that I created above to find our measures of risk/return trade-off. I will first annualize my monthly return. I will then annualize my monthly standard deviation, or volatility as we say in finance. I am “cheating” a bit on my volatility annualization. These are discrete returns. Multiplying by the square root of the number of your time periods in a year (12, because we have montly returns) really only works if you have log returns.</p>
<p>See the DataCamp assignment and your Principles of Finance notes for more on these calculations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">risk_free</span> <span class="o">=</span> <span class="mf">0.02</span>
 
<span class="n">port_ret</span> <span class="o">=</span> <span class="n">rets_with_port</span><span class="o">.</span><span class="n">port_ret</span>
<span class="n">port_ret</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    222.000000
mean       0.006662
std        0.018696
min       -0.092835
25%       -0.004634
50%        0.006880
75%        0.017815
max        0.065128
Name: port_ret, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">annualized_return</span><span class="o">=</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">port_ret</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">**</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span>
<span class="n">annualized_vol</span> <span class="o">=</span> <span class="n">port_ret</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">**</span></code> denotes exponent, while <code class="docutils literal notranslate"><span class="pre">*</span></code> is multiplication in Python.</p>
<p>We can then calculate the <strong>Sharpe Ratio</strong>, which is the ratio of returns above the risk-free rate to the volatility (i.e. the risk) in the portfolio.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sharpe_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="n">annualized_return</span> <span class="o">-</span> <span class="n">risk_free</span><span class="p">)</span> <span class="o">/</span> <span class="n">annualized_vol</span>
<span class="n">sharpe_ratio</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9717568897720553
</pre></div>
</div>
</div>
</div>
<p>We have a Sharpe near 1. That’s pretty high! Hedge fund strategies often take risks that are not well-defined by standard deviation. For example, if a strategy has a lot of negative skewness, then we would expect to occasionally have large losses. Volatility doesn’t capture that type of risk.</p>
<p>Returns that are “too smooth” can also create artificially low Sharpe Ratios. For example, if a strategy holds illiquid securities that are not marked-to-market (or priced) consistently, then the reported returns won’t affect the actual volatility of the positions if they were priced, say, daily. For example, many venture capital and private equity strategies only mark, or change the prices of their investments, quarterly. A mutual fund is going to see their positions market daily. ETFs trade throughout the day. Private equity strategies look less volatile than they really are and, so, have higher Sharpe ratios than they do in reality.</p>
<p>We can also calculate the <strong>Sortino Ratio</strong>. This looks very similar to the Sharpe Ratio, expect that we only calculate the standard deviation using returns below some target, or threshold. So, we are interesting in volatility during bad times, not just overall volatility. We often use a target of 0 to look at negative returns, but you can choose something else if that’s appropriate.</p>
<p>Note that I am masking with <code class="docutils literal notranslate"><span class="pre">.loc</span></code> to get just the negative returns from the <em>port_ret</em> Series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_return</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">negative_returns</span> <span class="o">=</span> <span class="n">port_ret</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">port_ret</span> <span class="o">&lt;</span> <span class="n">target_return</span><span class="p">]</span>

<span class="n">down_stdev</span> <span class="o">=</span> <span class="n">negative_returns</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

<span class="n">sortino_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="n">annualized_return</span> <span class="o">-</span> <span class="n">risk_free</span><span class="p">)</span><span class="o">/</span><span class="n">down_stdev</span>

<span class="n">sortino_ratio</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.4514485366477672
</pre></div>
</div>
</div>
</div>
</section>
<section id="drawdowns">
<h2><span class="section-number">8.6. </span>Drawdowns<a class="headerlink" href="#drawdowns" title="Permalink to this headline">#</a></h2>
<p>We might also be interested in draw-downs, or what the bad times look like, how long they last, and how long it takes to get our money back.</p>
<p>We will calculate the cumulative portfolio return, the previous maximum cumulative return (often called a <strong>high water mark</strong>), and the percentage below the high water mark at any point.</p>
<p>I print my index, just to show you that <em>date</em> is the index of the <em>port_drawdown</em> DataFrame. So, my x-axis in my plots can just be <code class="docutils literal notranslate"><span class="pre">port_drawdown.index</span></code>.</p>
<p>I am using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and <code class="docutils literal notranslate"><span class="pre">plt.plot</span></code> to make two stacked line charts. I find this to be the easiest way, even if it is more verbose. You can really see what you’re doing in each step.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">port_ret_cum</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">port_ret</span><span class="p">)</span><span class="o">.</span><span class="n">cumprod</span><span class="p">()</span>
<span class="n">previous_peaks</span> <span class="o">=</span> <span class="n">port_ret_cum</span><span class="o">.</span><span class="n">cummax</span><span class="p">()</span>
<span class="n">drawdowns</span> <span class="o">=</span> <span class="p">(</span><span class="n">port_ret_cum</span> <span class="o">-</span> <span class="n">previous_peaks</span><span class="p">)</span><span class="o">/</span><span class="n">previous_peaks</span>

<span class="n">port_drawdown</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Cumulative Return&#39;</span><span class="p">:</span> <span class="n">port_ret_cum</span><span class="p">,</span> <span class="s1">&#39;Previous Peak&#39;</span><span class="p">:</span> <span class="n">previous_peaks</span><span class="p">,</span> <span class="s1">&#39;Drawdown&#39;</span><span class="p">:</span> <span class="n">drawdowns</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">port_drawdown</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;1994-01-31&#39;, &#39;1994-02-28&#39;, &#39;1994-03-31&#39;, &#39;1994-04-29&#39;,
               &#39;1994-05-31&#39;, &#39;1994-06-30&#39;, &#39;1994-07-29&#39;, &#39;1994-08-31&#39;,
               &#39;1994-09-30&#39;, &#39;1994-10-31&#39;,
               ...
               &#39;2011-09-30&#39;, &#39;2011-10-31&#39;, &#39;2011-11-30&#39;, &#39;2011-12-30&#39;,
               &#39;2012-01-31&#39;, &#39;2012-02-29&#39;, &#39;2012-03-30&#39;, &#39;2012-04-30&#39;,
               &#39;2012-05-31&#39;, &#39;2012-06-29&#39;],
              dtype=&#39;datetime64[ns]&#39;, name=&#39;date&#39;, length=222, freq=None)
</pre></div>
</div>
</div>
</div>
<p>Let’s make the graph. You’ll see that the Great Financial Crisis was the high water mark, at least in this data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">port_drawdown</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">port_drawdown</span><span class="p">[</span><span class="s1">&#39;Cumulative Return&#39;</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cumulative Portfolio Returns&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">port_drawdown</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">port_drawdown</span><span class="p">[</span><span class="s1">&#39;Previous Peak&#39;</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Previous High Water Mark&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cumulative Returns&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hedge Fund Portfolio Drawdowns&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">port_drawdown</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">port_drawdown</span><span class="p">[</span><span class="s1">&#39;Drawdown&#39;</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Drawdown&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Return&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8_port_math_49_0.png" src="../_images/8_port_math_49_0.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="7_nasdaq_api.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">7. </span>Using NASDAQ BTC data <a id='btc-sim'></a></p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="9_portfolio_opt.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">9. </span>Portfolio optimization</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Prof. Adam Aiken<br/>
  
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>